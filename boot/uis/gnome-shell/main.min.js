!function(){if(!Webos.Icon){var a=["/usr/lib/webos/theme.js"],b=null;Webos.standalone&&a.push({path:"/usr/share/icons/index.json",process:function(a){b=$.parseJSON(a)}}),Webos.require(a,function(){Webos.Icon=function(a,b,c){"undefined"==typeof a&&(a="apps/default"),"undefined"!=typeof Webos.Icon.sizes[b]&&(b=Webos.Icon.sizes[b]),this._originalName=a,this.setSize("undefined"==typeof b?48:b),this.setTheme(c),this.setName(a),/^[\/(~\/)]/.test(this.name)||(Webos.Icon._cache[this.id()]=this)},Webos.Icon.prototype={id:function(a,b){return/^[\/(~\/)]/.test(this.name)?void 0:(a="undefined"==typeof a?this.size:a,"undefined"!=typeof Webos.Icon._cache[this.name]&&Webos.Icon._cache[this.name].size>=a?Webos.Icon._cache[this.name].id(a,b):"themes"==this.type?(b="undefined"==typeof b?"undefined"==typeof this.theme?Webos.Theme.current().get("icons"):this.theme:a,this.type+"/"+b+"/"+a+"/"+this.name):this.type+"/"+a+"/"+this.name)},path:function(a,b){var c=this.id(a,b);return"undefined"==typeof c?this.name:Webos.Icon._path+"/"+c+".png"},realpath:function(a,b){var c=this.id(a,b),d="";if("undefined"==typeof c){var e=this.name;this.extension&&(e+="."+this.extension);var f=W.File.get(e);d=f.get("realpath")}else if(Webos.standalone){var g="",h=Webos.Icon._findInIndex(this);if(h&&(g=Webos.Icon._path+"/"+h.originalName()),g){var f=W.File.get(g);d=f.get("realpath")}}else d="sbin/rawdatacall.php?type=icon&index="+c,Webos.Icon.supportsSvg()&&(d+="&svg=1");return d},is:function(a){return a=Webos.Icon.toIcon(a),this.type==a.type&&this.name==a.name?!0:!1},matches:function(a){if(!this.is(a))return 0;var b=1;return this.size<=a.size&&b++,(this.size==a.size||"scalable"==a.size)&&b++,this.theme==a.theme&&b++,b},setName:function(a){var b=/\./.test(a)?/[^.]+$/.exec(a)[0]:"";b&&(a=a.substr(0,a.lastIndexOf(".")),this.setExtension(b));var c=a.split("/"),d=Webos.Icon.types[0];~$.inArray(c[0],Webos.Icon.types)&&(d=c.shift()),"themes"==d&&4==c.length&&this.setTheme(c.shift()),("themes"==d&&3==c.length||"themes"!=d&&2==c.length)&&this.setSize(c.shift()),a=c.join("/"),this.name=a,this.type=d},setSize:function(a){return"scalable"!=a&&(a=parseInt(a),isNaN(a))?!1:void(this.size=a||48)},setTheme:function(a){this.theme=a||Webos.Theme.current().get("icons")},setExtension:function(a){this.extension=a},originalName:function(){return this._originalName},toString:function(){return this.realpath()}},Webos.Icon.types=["themes","applications","categories"],Webos.Icon._path="/usr/share/icons",Webos.Icon.sizes={button:24},Webos.Icon._cache={},Webos.Icon._index=b,Webos.Icon.toIcon=function(a){if(a instanceof Webos.Icon)return a;if(a instanceof Array&&"string"==typeof a[0])return new Webos.Icon(a[0],a[1],a[2]);switch(typeof a){case"object":if(a.name)return new Webos.Icon(a.name,a.size,a.theme);case"string":return new Webos.Icon(a);default:return new Webos.Icon}},Webos.Icon.supportsSvg=function(){return!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect},Webos.Icon._findInIndex=function(a){a=W.Icon.toIcon(a);for(var b=[],c=0;c<Webos.Icon._index.length;c++){var d=Webos.Icon._index[c];"string"==typeof d&&(d=Webos.Icon.toIcon(d),Webos.Icon._index[c]=d);var e=a.matches(d);e>0&&b.push({icon:d,score:e})}return b.length?(b.sort(function(a,b){return b.score-a.score}),b[0].icon):null}})}}(),function(){Webos.Theme||Webos.require("/usr/lib/webos/config.js",function(){Webos.Theme=function(a){var b=a.data(),c={desktop:"",icons:"",background:"",animations:0};b=$.extend({},c,b),"string"==typeof b.animations&&(b.animations=parseInt(b.animations)||0),Webos.Model.call(this,b),this._configFile=a},Webos.Theme.prototype={_stylesheets:[],load:function(a){a=Webos.Callback.toCallback(a);var b=this;return new W.ServerCall({"class":"ThemeController",method:"loadCss",arguments:{theme:b.get("desktop"),ui:Webos.UserInterface.Booter.current().name()}}).load([function(c){var d=Webos.Theme.current();d.unload(),b._setAnimations();var e=c.getData().css;for(var f in e)b._stylesheets.push(Webos.Stylesheet.insertCss(e[f],"#"+W.UserInterface.Booter.current().element().attr("id")));b._loadBackground(),Webos.Theme._current=b,a.success(),b.trigger("load"),Webos.Theme.trigger("load",{theme:b})},a.error])},unload:function(){for(var a=0;a<this._stylesheets.length;a++)Webos.Stylesheet.removeCss(this._stylesheets[a])},applyBackgroundOn:function(a){var b=$(a),c=Webos.File.get(this.get("background")).get("realpath"),d=this.get("backgroundColor"),e=this.get("backgroundRepeat"),f="no-repeat"==e?!0:!1;return this.get("hideBackground")?void b.css("background-color",d):(b.css("background",'url("'+c+'") '+e+" center center "+d),void(f&&b.css("-webkit-background-size","cover").css("-moz-background-size","cover").css("-o-background-size","cover").css("background-size","cover").css("filter","progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+c+"', sizingMethod='scale')").css("-ms-filter","\"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+c+"', sizingMethod='scale')\"")))},_loadBackground:function(a){Webos.Theme._current&&a!==!0&&Webos.Theme._current.get("background")==this.get("background")||this.applyBackgroundOn(Webos.UserInterface.Booter.current().element())},_setAnimations:function(){$.fx.off=!this.get("animations")},background:function(){var a=this._get("background");return a||(a=Webos.Theme.defaultBackground()),a},backgroundColor:function(){return this._get("backgroundColor")||"black"},backgroundRepeat:function(){return this._get("backgroundRepeat")||"no-repeat"},hideBackground:function(){return this._get("hideBackground")?!0:!1},setDesktop:function(a){return this._set("desktop",String(a)),!0},setBackground:function(a){return a=String(a),a==Webos.Theme.defaultBackground()&&(a=""),this._set("background",a),!0},setIcons:function(a){return this._set("icons",String(a)),!0},setAnimations:function(a){return this._set("animations",a?1:0),!0},sync:function(a){a=Webos.Callback.toCallback(a);var b=this,c={},d=0;for(var e in this._unsynced)1===this._unsynced[e].state&&(this._unsynced[e].state=2,c[e]=this._unsynced[e].value,this._configFile.set(e,c[e]),d++);return 0==d?void a.success(this):void this._configFile.sync([function(){for(var c in b._unsynced)if(2===b._unsynced[c].state){switch(b._data[c]=b._unsynced[c].value,delete b._unsynced[c],c){case"background":b._loadBackground(!0);break;case"animations":b._setAnimations()}b.notify("update",{key:c,value:b._data[c].value})}a.success(b)},a.error])}},Webos.inherit(Webos.Theme,Webos.Model),Webos.Observable.build(Webos.Theme),Webos.Theme._current=null,Webos.Theme.current=function(){return Webos.Theme._current||new Webos.Theme(Webos.ConfigFile.get("~/.theme/"+Webos.UserInterface.Booter.current().name()+"/config.xml"))},Webos.Theme._defaultBackground="/usr/share/images/backgrounds/default.jpg",Webos.Theme.defaultBackground=function(){return Webos.Theme._defaultBackground},Webos.Theme.setDefaultBackground=function(a){Webos.Theme._defaultBackground=a},Webos.Theme.get=function(a){a=Webos.Callback.toCallback(a);var b=Webos.UserInterface.Booter.current().name();Webos.ConfigFile.loadUserConfig("~/.theme/"+b+"/config.xml","/usr/etc/uis/"+b+"/config.xml",[function(b){var c=new Webos.Theme(b);a.success(c)},a.error])},Webos.Theme.backgroundsDir="/usr/share/images/backgrounds/",Webos.Theme.iconsDir="/usr/share/icons/themes/",Webos.Theme.getAvailable=function(a,b){b=Webos.Callback.toCallback(b),new W.ServerCall({"class":"ThemeController",method:"getAvailable",arguments:{ui:W.UserInterface.Booter.current().name()}}).load(new Webos.Callback(function(a){b.success(a.getData())},function(a){b.error(a)}))}})}(),function(a){function b(a){if(a in l.style)return a;var b=["Moz","Webkit","O","ms"],c=a.charAt(0).toUpperCase()+a.substr(1);if(a in l.style)return a;for(var d=0;d<b.length;++d){var e=b[d]+c;if(e in l.style)return e}}function c(){return l.style[m.transform]="",l.style[m.transform]="rotateY(90deg)",""!==l.style[m.transform]}function d(a){return"string"==typeof a&&this.parse(a),this}function e(a,b,c){b===!0?a.queue(c):b?a.queue(b,c):c()}function f(b){var c=[];return a.each(b,function(b){b=a.camelCase(b),b=a.transit.propertyMap[b]||a.cssProps[b]||b,b=i(b),-1===a.inArray(b,c)&&c.push(b)}),c}function g(b,c,d,e){var g=f(b);a.cssEase[d]&&(d=a.cssEase[d]);var h=""+k(c)+" "+d;parseInt(e,10)>0&&(h+=" "+k(e));var i=[];return a.each(g,function(a,b){i.push(b+" "+h)}),i.join(", ")}function h(b,c){c||(a.cssNumber[b]=!0),a.transit.propertyMap[b]=m.transform,a.cssHooks[b]={get:function(c){var d=a(c).css("transit:transform");return d.get(b)},set:function(c,d){var e=a(c).css("transit:transform");e.setFromString(b,d),a(c).css({"transit:transform":e})}}}function i(a){return a.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()})}function j(a,b){return"string"!=typeof a||a.match(/^[\-0-9\.]+$/)?""+a+b:a}function k(b){var c=b;return a.fx.speeds[c]&&(c=a.fx.speeds[c]),j(c,"ms")}a.transit={version:"0.9.9",propertyMap:{marginLeft:"margin",marginRight:"margin",marginBottom:"margin",marginTop:"margin",paddingLeft:"padding",paddingRight:"padding",paddingBottom:"padding",paddingTop:"padding"},enabled:!0,useTransitionEnd:!1};var l=document.createElement("div"),m={},n=navigator.userAgent.toLowerCase().indexOf("chrome")>-1;m.transition=b("transition"),m.transitionDelay=b("transitionDelay"),m.transform=b("transform"),m.transformOrigin=b("transformOrigin"),m.transform3d=c();var o={transition:"transitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd",msTransition:"MSTransitionEnd"},p=m.transitionEnd=o[m.transition]||null;for(var q in m)m.hasOwnProperty(q)&&"undefined"==typeof a.support[q]&&(a.support[q]=m[q]);l=null,a.cssEase={_default:"ease","in":"ease-in",out:"ease-out","in-out":"ease-in-out",snap:"cubic-bezier(0,1,.5,1)",easeOutCubic:"cubic-bezier(.215,.61,.355,1)",easeInOutCubic:"cubic-bezier(.645,.045,.355,1)",easeInCirc:"cubic-bezier(.6,.04,.98,.335)",easeOutCirc:"cubic-bezier(.075,.82,.165,1)",easeInOutCirc:"cubic-bezier(.785,.135,.15,.86)",easeInExpo:"cubic-bezier(.95,.05,.795,.035)",easeOutExpo:"cubic-bezier(.19,1,.22,1)",easeInOutExpo:"cubic-bezier(1,0,0,1)",easeInQuad:"cubic-bezier(.55,.085,.68,.53)",easeOutQuad:"cubic-bezier(.25,.46,.45,.94)",easeInOutQuad:"cubic-bezier(.455,.03,.515,.955)",easeInQuart:"cubic-bezier(.895,.03,.685,.22)",easeOutQuart:"cubic-bezier(.165,.84,.44,1)",easeInOutQuart:"cubic-bezier(.77,0,.175,1)",easeInQuint:"cubic-bezier(.755,.05,.855,.06)",easeOutQuint:"cubic-bezier(.23,1,.32,1)",easeInOutQuint:"cubic-bezier(.86,0,.07,1)",easeInSine:"cubic-bezier(.47,0,.745,.715)",easeOutSine:"cubic-bezier(.39,.575,.565,1)",easeInOutSine:"cubic-bezier(.445,.05,.55,.95)",easeInBack:"cubic-bezier(.6,-.28,.735,.045)",easeOutBack:"cubic-bezier(.175, .885,.32,1.275)",easeInOutBack:"cubic-bezier(.68,-.55,.265,1.55)"},a.cssHooks["transit:transform"]={get:function(b){return a(b).data("transform")||new d},set:function(b,c){var e=c;e instanceof d||(e=new d(e)),b.style[m.transform]="WebkitTransform"!==m.transform||n?e.toString():e.toString(!0),a(b).data("transform",e)}},a.cssHooks.transform={set:a.cssHooks["transit:transform"].set},a.fn.jquery<"1.8"&&(a.cssHooks.transformOrigin={get:function(a){return a.style[m.transformOrigin]},set:function(a,b){a.style[m.transformOrigin]=b}},a.cssHooks.transition={get:function(a){return a.style[m.transition]},set:function(a,b){a.style[m.transition]=b}}),h("scale"),h("translate"),h("rotate"),h("rotateX"),h("rotateY"),h("rotate3d"),h("perspective"),h("skewX"),h("skewY"),h("x",!0),h("y",!0),d.prototype={setFromString:function(a,b){var c="string"==typeof b?b.split(","):b.constructor===Array?b:[b];c.unshift(a),d.prototype.set.apply(this,c)},set:function(a){var b=Array.prototype.slice.apply(arguments,[1]);this.setter[a]?this.setter[a].apply(this,b):this[a]=b.join(",")},get:function(a){return this.getter[a]?this.getter[a].apply(this):this[a]||0},setter:{rotate:function(a){this.rotate=j(a,"deg")},rotateX:function(a){this.rotateX=j(a,"deg")},rotateY:function(a){this.rotateY=j(a,"deg")},scale:function(a,b){void 0===b&&(b=a),this.scale=a+","+b},skewX:function(a){this.skewX=j(a,"deg")},skewY:function(a){this.skewY=j(a,"deg")},perspective:function(a){this.perspective=j(a,"px")},x:function(a){this.set("translate",a,null)},y:function(a){this.set("translate",null,a)},translate:function(a,b){void 0===this._translateX&&(this._translateX=0),void 0===this._translateY&&(this._translateY=0),null!==a&&void 0!==a&&(this._translateX=j(a,"px")),null!==b&&void 0!==b&&(this._translateY=j(b,"px")),this.translate=this._translateX+","+this._translateY}},getter:{x:function(){return this._translateX||0},y:function(){return this._translateY||0},scale:function(){var a=(this.scale||"1,1").split(",");return a[0]&&(a[0]=parseFloat(a[0])),a[1]&&(a[1]=parseFloat(a[1])),a[0]===a[1]?a[0]:a},rotate3d:function(){for(var a=(this.rotate3d||"0,0,0,0deg").split(","),b=0;3>=b;++b)a[b]&&(a[b]=parseFloat(a[b]));return a[3]&&(a[3]=j(a[3],"deg")),a}},parse:function(a){var b=this;a.replace(/([a-zA-Z0-9]+)\((.*?)\)/g,function(a,c,d){b.setFromString(c,d)})},toString:function(a){var b=[];for(var c in this)if(this.hasOwnProperty(c)){if(!m.transform3d&&("rotateX"===c||"rotateY"===c||"perspective"===c||"transformOrigin"===c))continue;"_"!==c[0]&&b.push(a&&"scale"===c?c+"3d("+this[c]+",1)":a&&"translate"===c?c+"3d("+this[c]+",0)":c+"("+this[c]+")")}return b.join(" ")}},a.fn.transition=a.fn.transit=function(b,c,d,f){var h=this,i=0,j=!0;"function"==typeof c&&(f=c,c=void 0),"function"==typeof d&&(f=d,d=void 0),"undefined"!=typeof b.easing&&(d=b.easing,delete b.easing),"undefined"!=typeof b.duration&&(c=b.duration,delete b.duration),"undefined"!=typeof b.complete&&(f=b.complete,delete b.complete),"undefined"!=typeof b.queue&&(j=b.queue,delete b.queue),"undefined"!=typeof b.delay&&(i=b.delay,delete b.delay),"undefined"==typeof c&&(c=a.fx.speeds._default),"undefined"==typeof d&&(d=a.cssEase._default),c=k(c);var l=g(b,c,d,i),n=a.transit.enabled&&m.transition,o=n?parseInt(c,10)+parseInt(i,10):0;if(0===o){var q=function(a){h.css(b),f&&f.apply(h),a&&a()};return e(h,j,q),h}var r={},s=function(c){var d=!1,e=function(){d&&h.unbind(p,e),o>0&&h.each(function(){this.style[m.transition]=r[this]||null}),"function"==typeof f&&f.apply(h),"function"==typeof c&&c()};o>0&&p&&a.transit.useTransitionEnd?(d=!0,h.bind(p,e)):window.setTimeout(e,o),h.each(function(){o>0&&(this.style[m.transition]=l),a(this).css(b)})},t=function(a){this.offsetWidth,s(a)};return e(h,j,t),this},a.transit.getTransitionValue=g}(jQuery);var browserPrefixes="webkit moz o ms khtml".split(" ");if(Webos.fullscreen={support:!1,_stack:[],_stackLength:0,isFullScreen:function(){return!1},request:function(){},cancel:function(){},eventName:"",prefix:""},"undefined"!=typeof document.cancelFullScreen)Webos.fullscreen.support=!0;else for(var i=0,il=browserPrefixes.length;il>i;i++)if(Webos.fullscreen.prefix=browserPrefixes[i],"undefined"!=typeof document[Webos.fullscreen.prefix+"CancelFullScreen"]){Webos.fullscreen.support=!0;break}Webos.fullscreen.support&&(Webos.fullscreen.eventName=Webos.fullscreen.prefix+"fullscreenchange",Webos.fullscreen.isFullScreen=function(){switch(this.prefix){case"":return document.fullScreen;case"webkit":return document.webkitIsFullScreen;default:return document[this.prefix+"FullScreen"]}},Webos.fullscreen._request=function(a){return""===this.prefix?a.requestFullScreen():a[this.prefix+"RequestFullScreen"]()},Webos.fullscreen.request=function(a){return a=$(a)[0],Webos.fullscreen.isFullScreen()&&Webos.fullscreen._cancel(),Webos.fullscreen._stack.push(a),Webos.fullscreen._stackLength++,Webos.fullscreen._request(a)},Webos.fullscreen._cancel=function(){return""===this.prefix?document.cancelFullScreen():document[this.prefix+"CancelFullScreen"]()},Webos.fullscreen.cancel=function(){Webos.fullscreen._cancel(),Webos.fullscreen._stack.pop(),Webos.fullscreen._stackLength--,Webos.fullscreen._stackLength&&Webos.fullscreen._request(Webos.fullscreen._stack[Webos.fullscreen._stackLength-1])}),"undefined"!=typeof jQuery&&(jQuery.fn.requestFullScreen=function(){return this.each(function(){Webos.fullscreen.support&&Webos.fullscreen.request(this)})}),function(a){function b(b){var c=b||window.event,d=[].slice.call(arguments,1),e=0,f=0,g=0;return b=a.event.fix(c),b.type="mousewheel",c.wheelDelta&&(e=c.wheelDelta/120),c.detail&&(e=-c.detail/3),g=e,void 0!==c.axis&&c.axis===c.HORIZONTAL_AXIS&&(g=0,f=-1*e),void 0!==c.wheelDeltaY&&(g=c.wheelDeltaY/120),void 0!==c.wheelDeltaX&&(f=-1*c.wheelDeltaX/120),d.unshift(b,e,f,g),(a.event.dispatch||a.event.handle).apply(this,d)}var c=["DOMMouseScroll","mousewheel"];if(a.event.fixHooks)for(var d=c.length;d;)a.event.fixHooks[c[--d]]=a.event.mouseHooks;a.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var a=c.length;a;)this.addEventListener(c[--a],b,!1);else this.onmousewheel=b},teardown:function(){if(this.removeEventListener)for(var a=c.length;a;)this.removeEventListener(c[--a],b,!1);else this.onmousewheel=null}},a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})}(jQuery),Webos.Clipboard={_cache:null,_storeItem:function(a){Webos.Clipboard._cache=a},copy:function(a){var b=new Webos.Clipboard.Item(a,"copy");return Webos.Clipboard._storeItem(b),Webos.Clipboard.notify("copy",{item:b}),b},cut:function(a){var b=new Webos.Clipboard.Item(a,"cut");return Webos.Clipboard._storeItem(b),Webos.Clipboard.notify("cut",{item:b}),b},get:function(){return Webos.Clipboard._cache},clear:function(){Webos.Clipboard._cache=null,Webos.Clipboard.notify("clear")}},Webos.Observable.build(Webos.Clipboard),Webos.Clipboard.Item=function(a,b){this._data=a,this._operation=b,Webos.Observable.call(this)},Webos.Clipboard.Item.prototype={is:function(a){return Webos.isInstanceOf(this._data,a)},operation:function(){return this._operation},paste:function(a,b){a=Webos.Callback.toCallback(a),a.success(this._data),b||this.pasted()},pasted:function(){this.notify("paste"),Webos.Clipboard.notify("paste",{item:this})},setData:function(a){this._data=a}},Webos.inherit(Webos.Clipboard.Item,Webos.Observable),function(a){Webos.require("/usr/share/css/gtk/widgets.css"),a.webos={},a.webos.widget=function(b){b=String(b);var c,d,e;if("string"==typeof arguments[1]?(d=arguments[1],a[a.webos.widget.namespace()][d]&&(e=a[a.webos.widget.namespace()][d]),"object"==typeof arguments[2]?c=arguments[2]:a.webos[b]&&a.webos[b].prototype&&(c=a.webos[b].prototype)):"object"==typeof arguments[1]?c=arguments[1]:"undefined"==typeof arguments[1]&&a.webos[b]&&a.webos[b].prototype&&(c=a.webos[b].prototype),"object"!=typeof c)return!1;c.widgetEventPrefix=b.toLowerCase(),c.widgetBaseClass="webos-"+b.toLowerCase();var f=a.webos[b],g=a.webos.widget.namespace()+"."+b;if(e?a.widget(g,e,c):a.widget(g,c),a[a.webos.widget.namespace()][b].prototype._translationsName&&(e=a[a.webos.widget.namespace()][b],a.widget(g,e,{_translations:new Webos.Translation,_create:function(){if(this._translations.isEmpty()){var a=this,b=arguments,c=this._super;Webos.Translation.load(function(d){a._translations=d,c.apply(a,b)},this._translationsName)}else this._superApply(arguments)},translations:function(){return this._translations}})),"function"==typeof f){for(var h=a.webos[b],i=Object.keys(h),j=0;j<i.length;j++)f[i]=h[i];a.webos[b]=f}},a.webos.subwidget=function(b,c,d){var e=b+"."+c,f=function(c){return a(this)[b](c),d([],a(this)),a(this)};f.prototype=a[a.webos.widget.namespace()][b].prototype,a[a.webos.widget.namespace()][e]=f,a.fn[e]=f,a.webos[b]&&(a.webos[b][c]=function(){var c=Array.prototype.slice.call(arguments),e=a.webos[b]();return d(c,e),e})},a.webos.widget._namespace="gtk",a.webos.widget.namespace=function(){return a.webos.widget._namespace},a.webos.widget._widgetSelector=function(b){return":data('"+a.webos.widget.namespace()+"-"+b+"')"},a.webos.widget.is=function(b,c){return a(b).is(a.webos.widget._widgetSelector(c))},a.webos.widget.filter=function(b,c){return a(b).filter(a.webos.widget._widgetSelector(c))},a.webos.widget.get=function(b){var c=a.webos.widget.listAll();for(var d in c)if(a.webos.widget.is(b,d))return d},a.webos.widget.listAll=function(){return a[a.webos.widget.namespace()]},a.webos.widget.list=function(){return a.webos.widget.listAll()},a.webos.widgets=[],a.webos.getWidgets=function(b){return b?a(a.webos.widgets).filter(a.webos.widget._widgetSelector(b)):a(a.webos.widgets)},a.webos.widget.prototype={_name:"widget",options:{id:0,pid:null},_create:function(){this._super("_create");if(this.options.id=a.webos.widgets.push(this.element)-1,"undefined"!=typeof Webos.Process.current()){var b=Webos.Process.current();this.options.pid=b.getPid()}this.element.addClass("webos-"+this._name),this.element.attr("id","webos-widget-"+this.options.id)},id:function(){return this.options.id},pid:function(){return this.options.pid},destroy:function(){this._trigger("destroy",{type:"destroy"}),delete a.webos.widgets[this.options.id],this._super("destroy")},_setOption:function(a,b){this.options[a]=b,this._update(a,b)},selector:function(){return"#"+this.element.attr("id")},_update:function(){}},a.webos.widget("widget"),a.webos.container=function(){return a("<div></div>").container()},a.webos.container.prototype={_name:"container",options:{_content:void 0,_components:{}},_create:function(){this._super("_create"),this.options._content=this.element},content:function(){return this.options._content},add:function(a){this.options._content.append(a),a.trigger("insert")},component:function(a){return this.options._components[a]}},a.webos.widget("container","widget"),a.webos.scrollPane=function(b){return a("<div></div>").scrollPane(b)},a.webos.scrollPane.prototype={_name:"scrollpane",options:{autoReload:!1,horizontalDragMinWidth:20,verticalDragMinHeight:20,animate:!1,mouseWheelSpeed:30,expand:!1,keyUpResize:!1,alsoResize:null,forceArtificialScrollbars:!1,forceStyledScrollbars:!1},_create:function(){this._super("_create");var b=this;if(this.isNatural())this.element.addClass("scrollpane-natural"),this.options._content=a("<div></div>",{"class":"pane-natural"}).appendTo(this.element),this.element.scroll(function(){b._trigger("scroll")});else{var c=this.element.scrollTop(),d=this.element.scrollLeft();this.element.attr("tabindex",0),this.options._components.container=a("<div></div>",{"class":"container"}),this.options._content=a("<div></div>",{"class":"pane"}),this.element.wrapInner(this.options._components.container),this.options._components.container.wrapInner(this.options._content),this.options._components.verticalBar=a('<div class="vertical-bar" />').append(a('<div class="cap cap-top" />'),a('<div class="track" />').append(a('<div class="background" />'),a('<div class="drag-container" />').append(a('<div class="drag" />').append(a('<div class="drag-top" />'),a('<div class="drag-bottom" />')))),a('<div class="cap cap-bottom" />')).appendTo(this.element),this.options._components.horizontalBar=a('<div class="horizontal-bar" />').append(a('<div class="corner" />'),a('<div class="cap cap-left" />'),a('<div class="track" />').append(a('<div class="background" />'),a('<div class="drag-container" />').append(a('<div class="drag" />').append(a('<div class="drag-left" />'),a('<div class="drag-right" />')))),a('<div class="cap cap-right" />')).appendTo(this.element),this._track()}this._update("autoReload",this.options.autoReload),this._update("expand",this.options.expand),this._update("keyUpResize",this.options.keyUpResize),this._update("alsoResize",this.options.alsoResize),this.reload(),0!=c&&this.scrollToY(c),0!=d&&this.scrollToX(d)},isNatural:function(){return!this.options.forceArtificialScrollbars&&(!this.options.forceStyledScrollbars||navigator.userAgent&&/(webkit|chrome|safari)/i.test(navigator.userAgent))},_track:function(){var b=this,c=function(){a("html").unbind("dragstart.scrollpane.widget.webos selectstart.scrollpane.widget.webos mousemove.scrollpane.widget.webos mouseup.scrollpane.widget.webos mouseleave.scrollpane.widget.webos")};this.options._components.verticalBar.bind("mousedown.scrollpane.widget.webos",function(d){a("html").bind("dragstart.scrollpane.widget.webos selectstart.scrollpane.widget.webos",function(a){a.preventDefault()});var e=d.pageY-b.options._components.verticalBar.find(".drag-container").position().top;$this=a(this),a("html").bind("mousemove.scrollpane.widget.webos",function(a){b.positionDragY(a.pageY-e,!1)}).bind("mouseup.scrollpane.widget.webos mouseleave.scrollpane.widget.webos",function(){$this.removeClass("dragging"),c()}),a(this).addClass("dragging"),d.preventDefault()}).bind("click.scrollpane.widget.webos",function(a){a.preventDefault()}),this.options._components.horizontalBar.bind("mousedown.scrollpane.widget.webos",function(d){a("html").bind("dragstart.scrollpane.widget.webos selectstart.scrollpane.widget.webos",function(a){a.preventDefault()});var e=d.pageX-b.options._components.horizontalBar.find(".drag-container").position().left;$this=a(this),a("html").bind("mousemove.scrollpane.widget.webos",function(a){b.positionDragX(a.pageX-e,!1)}).bind("mouseup.scrollpane.widget.webos mouseleave.scrollpane.widget.webos",function(){$this.removeClass("dragging"),c()}),a(this).addClass("dragging"),d.preventDefault()}).bind("click.scrollpane.widget.webos",function(a){a.preventDefault()})},_mousewheel:function(b){var c=this,d=a.fn.mwheelIntent?"mwheelIntent.scrollpane.widget.webos":"mousewheel.scrollpane.widget.webos";b!==!1?this.element.unbind(d).bind(d,function(a,b,d,e){var f=c.element.data("scrollpane"),g=f.horizontalDragPosition,h=f.verticalDragPosition;return c.scrollBy(d*c.options.mouseWheelSpeed,-e*c.options.mouseWheelSpeed,!1),g==f.horizontalDragPosition&&h==f.verticalDragPosition}):this.element.unbind(d)},_touch:function(){},_focusHandler:function(){},_update:function(b,c){switch(b){case"autoReload":var d=this,e=a(window),f="resize."+this.id()+".scrollpane.widget.webos";this.element.parents().filter(".webos-window").length>0&&(e=this.element.parents().filter(".webos-window").first(),f="windowresize."+this.id()+".scrollpane.widget.webos windowopen."+this.id()+".scrollpane.widget.webos"),this.options.autoReload=c?!0:!1,c?(e.bind(f,function(b){(!e.is(window)||a(b.target).is(window))&&d.reload()}),a(window).bind("windowopen."+this.id()+".scrollpane.widget.webos",function(b,c){var g=d.element.parents().filter(c.window);(!d.options.autoReload||g.length>0)&&(a(this).unbind("windowopen."+d.id()+".scrollpane.widget.webos"),e.unbind(f)),g.length>0&&(d._update("autoReload",!0),d.reload())})):(e.unbind(f),a(window).unbind("windowopen."+this.id()+".scrollpane.widget.webos"));break;case"expand":this.options.expand=c?!0:!1,this.element.css(c?{width:"100%",height:"100%"}:{width:"",height:""});break;case"keyUpResize":if(this.options.keyUpResize=c?!0:!1,c){var d=this;this.element.bind("keyup.scrollpane.widget.webos",function(){d.reload()})}else this.element.unbind("keyup.scrollpane.widget.webos");break;case"alsoResize":c?this.isNatural()?a(c).css({"min-width":"100%","min-height":"100%"}):this.element.bind("scrollpanereload.scrollpane.widget.webos",function(b,d){a(c).css({"min-width":d.containerWidth-d.verticalTrackWidth,"min-height":d.containerHeight-d.horizontalTrackHeight,width:d.paneWidth,height:d.paneHeight})}).bind("scrollpanebeforereload.scrollpane.widget.webos",function(){a(c).css({"min-width":"auto","min-height":"auto",width:"auto",height:"auto"})}):this.element.unbind("scrollpanereload.scrollpane.widget.webos");break;case"forceArtificialScrollbars":case"forceStyledScrollbars":return!1}},positionDragY:function(a,b){var c=this.element.data("scrollpane");c.isScrollableV&&(0>a?a=0:a>c.dragMaxY&&(a=c.dragMaxY),"undefined"==typeof b&&(b=this.options.animate),b||(this.options._components.verticalBar.find(".drag-container").css("top",a),this._positionDragY(a)))},_positionDragY:function(a){var b=this.element.data("scrollpane");void 0===a&&(a=this.content().position().top),this.options._components.container.scrollTop(0);var c=a,d=0===c,e=c==b.dragMaxY,f=a/b.dragMaxY,g=Math.round(-f*(b.paneHeight-b.containerHeight));(b.wasAtTop!=d||b.wasAtBottom!=e)&&(b.wasAtTop=d,b.wasAtBottom=e,this.element.trigger("arrowchange",{},[b.wasAtTop,b.wasAtBottom,b.wasAtLeft,b.wasAtRight])),this.content().css("top",g),this._trigger("scrolly",{},[-g,d,e]),this._trigger("scroll"),this.element.data("scrollpane",b)},positionDragX:function(a,b){var c=this.element.data("scrollpane");c.isScrollableH&&(0>a?a=0:a>c.dragMaxX&&(a=c.dragMaxX),"undefined"==typeof b&&(b=this.options.animate),b||(this.options._components.horizontalBar.find(".drag-container").css("left",a),this._positionDragX(a)))},_positionDragX:function(a){var b=this.element.data("scrollpane");void 0===a&&(a=this.content().position().left),this.options._components.container.scrollTop(0);var c=a,d=0===c,e=c==b.dragMaxX,f=a/b.dragMaxX,g=Math.round(-f*(b.paneWidth-b.containerWidth));(b.wasAtLeft!=d||b.wasAtRight!=e)&&(b.wasAtLeft=d,b.wasAtRight=e,this._trigger("arrowchange",{},[b.wasAtTop,b.wasAtBottom,b.wasAtLeft,b.wasAtRight])),this.content().css("left",g),this._trigger("scrollx",{},[-g,d,e]),this._trigger("scroll"),this.element.data("scrollpane",b)},position:function(a){return"undefined"==typeof a?this.isNatural()?{x:this.element.scrollLeft(),y:this.element.scrollTop()}:(a=this.content().position(),{x:-a.left,y:-a.top}):void this.scrollTo(a.x,a.y)},scrollToX:function(a,b){if(this.isNatural())return void this.element.scrollLeft(a);var c=this.element.data("scrollpane");if(c.paneWidth-c.containerWidth!=0){var d=a/(c.paneWidth-c.containerWidth);this.positionDragX(d*c.dragMaxX,b)}},scrollToY:function(a,b){if(this.isNatural())return void this.element.scrollTop(a);var c=this.element.data("scrollpane");if(c.paneHeight-c.containerHeight!=0){var d=a/(c.paneHeight-c.containerHeight);this.positionDragY(d*c.dragMaxY,b)}},scrollTo:function(a,b,c){this.scrollToX(a,c),this.scrollToY(b,c)},scrollByX:function(a,b){var c=(this.element.data("scrollpane"),this.position().x+Math[0>a?"floor":"ceil"](a));this.scrollToX(c,b)},scrollByY:function(a,b){var c=(this.element.data("scrollpane"),this.position().y+Math[0>a?"floor":"ceil"](a));this.scrollToY(c,b)},scrollBy:function(a,b,c){this.scrollByX(a,c),this.scrollByY(b,c)},reload:function(){this._trigger("beforereload",{type:"beforereload"});var b={},c=this;return this.element.data("scrollpane",b),this.isNatural()?void c._trigger("reload",{type:"reload"},b):(this.element.css({overflow:"hidden",padding:0}),this.content().css({width:"auto",height:"auto"}),void setTimeout(function(){if(b.containerWidth=c.element.width(),b.containerHeight=c.element.height(),b.paneWidth=c.content().outerWidth(!0),b.paneHeight=c.content().outerHeight(!0),b.percentInViewH=b.paneWidth/b.containerWidth,b.percentInViewV=b.paneHeight/b.containerHeight,b.isScrollableV=b.percentInViewV>1,b.isScrollableH=b.percentInViewH>1,b.isScrollableH||b.isScrollableV){c.element.addClass("scrollable"),c.content().css({width:"auto",height:"auto"});var d=c.content().position().top,e=c.content().position().left;b.isScrollableV?(c.options._components.verticalBar.show(),d=-d+(b.paneHeight-b.containerHeight)<0?-(b.paneHeight-b.containerHeight):d):(c.options._components.verticalBar.hide(),d=0),b.isScrollableH?(c.options._components.horizontalBar.show(),e=-e+(b.paneWidth-b.containerWidth)<0?-(b.paneWidth-b.containerWidth):e):(c.options._components.horizontalBar.hide(),e=0),c.content().css({top:d,left:e}),b.horizontalTrackHeight=c.options._components.horizontalBar.children(".track").outerHeight(!0),b.verticalTrackWidth=c.options._components.verticalBar.outerWidth(!0),b.horizontalTrackWidth=b.containerWidth,b.verticalTrackHeight=b.containerHeight,c.element.find(">.vertical-bar>.cap:visible,>.vertical-bar>.arrow").each(function(){b.verticalTrackHeight-=a(c).outerHeight(!0)}),c.element.find(">.horizontal-bar>.cap:visible,>.horizontal-bar>.arrow").each(function(){b.horizontalTrackWidth-=a(c).outerWidth(!0)
}),c.options._components.container.width(b.containerWidth-b.verticalTrackWidth).height(b.containerHeight-b.horizontalTrackHeight),c.content().css({"min-width":b.containerWidth-b.verticalTrackWidth,"min-height":b.containerHeight-b.horizontalTrackHeight}),b.isScrollableH&&b.isScrollableV&&(b.verticalTrackHeight-=b.horizontalTrackHeight,c.options._components.horizontalBar.find(">.cap:visible,>.arrow").each(function(){b.horizontalTrackWidth+=a(c).outerWidth(!0)}),b.horizontalTrackWidth-=b.verticalTrackWidth,b.paneHeight-=b.verticalTrackWidth,b.containerHeight-=2*b.verticalTrackWidth,b.paneWidth-=b.horizontalTrackHeight,b.containerWidth-=2*b.horizontalTrackHeight,c.options._components.horizontalBar.find(".corner").height(b.horizontalTrackHeight).width(b.verticalTrackWidth));var f=c.options._components.verticalBar.find(".drag-container");if(b.isScrollableV){c.options._components.verticalBar.find(".track").height(b.verticalTrackHeight),b.verticalDragMarginY=parseInt(f.css("padding-top"),10)+parseInt(f.css("padding-bottom"),10);var g=Math.ceil(1/b.percentInViewV*b.verticalTrackHeight);g<c.options.verticalDragMinHeight&&(g=c.options.verticalDragMinHeight),b.verticalDragHeight=g+b.verticalDragMarginY,b.dragMaxY=b.verticalTrackHeight-b.verticalDragHeight;var h=d/(b.paneHeight-b.containerHeight);h>1&&(h=1),0>h&&(h=0),f.height(g).css("top",Math.round(h*b.dragMaxY))}var i=c.options._components.horizontalBar.find(".drag-container");if(b.isScrollableH){c.options._components.horizontalBar.find(".track").width(b.horizontalTrackWidth),b.horizontalDragMarginX=parseInt(i.css("padding-top"),10)+parseInt(i.css("padding-bottom"),10);var j=Math.ceil(1/b.percentInViewH*b.horizontalTrackWidth);j<c.options.horizontalDragMinWidth&&(j=c.options.horizontalDragMinWidth),b.horizontalDragWidth=j+b.horizontalDragMarginX,b.dragMaxX=b.horizontalTrackWidth-b.horizontalDragWidth;var h=e/(b.paneWidth-b.containerWidth);h>1&&(h=1),0>h&&(h=0),i.width(j).css("left",Math.round(h*b.dragMaxX))}c._mousewheel(!0)}else c.element.removeClass("scrollable"),c.options._components.horizontalBar.hide(),c.options._components.verticalBar.hide(),c.content().css({top:0,left:0,width:"100%",height:"100%"}),c._mousewheel(!1);c.element.data("scrollpane",b),c._trigger("reload",{type:"reload"},b)},5))}},a.webos.widget("scrollPane","container"),a.webos.label=function(b){return a("<div></div>").label({text:b})},a.webos.label.prototype={options:{text:""},_name:"label",_create:function(){this._super("_create"),this.options._content.html(this.options.text)},_update:function(a){switch(a){case"text":this.options._content.html(this.options.text)}}},a.webos.widget("label","container"),a.webos.image=function(b,c,d){return a("<img />").image({src:b,title:c,loadHidden:d})},a.webos.image.prototype={_name:"image",options:{src:"",title:"image",loadHidden:!0,animate:!1,img:null,parent:a()},_create:function(){if(!this.element.is("img")){var b=a("<img />");this.element.empty().append(b),this.element=b}this._super("_create"),this.option("title",this.options.title),this.option("src",this.options.src)},load:function(){if(!this.options.img){if(this.element.attr("src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3QEMDAMRXUW5DAAAABl0RVh0Q29tbWVudABDcmVhdGVkIHdpdGggR0lNUFeBDhcAAAANSURBVAjXY/j//z8DAAj8Av5cn8/aAAAAAElFTkSuQmCC"),!this.options.loadHidden){if(this.element.is(":hidden"))return;if(0==this.element.closest("html").length)return;var b,c,d,e="image.widget.webos",f=500,g=(new Date).getTime(),h=this.options.parent.length?this.options.parent:this.element.parent(),i=function(){var b;b=a.webos.widget.is(h,"scrollPane")?h.scrollPane("position"):{y:h.scrollTop(),x:h.scrollLeft()};var c={dim:{width:h.width(),height:h.height()},scroll:b,time:g};return h.data(e,c),c};if(b=this.element.position(),d=h.data(e),d?d.time+f<g&&(d=i()):d=i(),b.left>d.dim.width+d.scroll.x||b.top>d.dim.height+d.scroll.y)return;if(c={width:this.element.width(),height:this.element.height()},b.left+c.width<d.scroll.x||b.top+c.height<d.scroll.y)return}var j=this,k=String(this.options.src);this.options.img=new Image,this.options.img.onload=function(){j.options.animate&&j.element.css("opacity",0),j.element.attr("src",k),j.options.animate&&j.element.animate({opacity:1},"fast"),j._trigger("load",{type:"load"},{img:j.options.img})},this.options.img.onerror=function(){j._trigger("error",{type:"error"},{img:j.options.img})},this.options.img.onabort=function(){j._trigger("abort",{type:"abort"},{img:j.options.img})},this.options.img.src=k}},loaded:function(){return this.options.img?!0:!1},_update:function(b,c){switch(b){case"src":this.options.src=String(c),this.options.src&&this.load();break;case"title":this.element.attr("alt",c).attr("title",c);break;case"parent":var d=this,e=a(c);if(!e.length)return!1;var f=this.id()+".image.widget.webos",g="scroll."+f;a.webos.widget.is(e,"scrollPane")&&(g="scrollpanescroll."+f);var h,i=250,j=null,k=function(){h=(new Date).getTime(),j||(j=setTimeout(function(){j=null;var a=(new Date).getTime();a-h>i+50?k():(h=null,d.element.one("imageload",function(){e.unbind(g)}),d.load())},i))};e.bind(g,function(){k()})}}},a.webos.widget("image","widget"),a.webos.icon=function(b,c){return a("<img />").icon({src:b,size:c})},a.webos.icon.prototype={_name:"icon",options:{src:"",size:void 0,variant:""},_create:function(){this._super("_create"),this.options.size&&this.option("size",this.options.size),this.options.variant&&this.option("variant",this.options.variant)},_update:function(a,b){switch(a){case"src":if(!b)return;"string"!=typeof b||0!=b.indexOf("sbin/")&&0!=b.indexOf("usr/")?(this.options.src=W.Icon.toIcon(b),this.options.size&&this.options.src.setSize(this.options.size)):this.options.src=b,this.load();break;case"size":b=parseInt(b),this.options.src.setSize(b),this.element.css({width:b,height:b}),this.load();break;case"variant":b=String(b),this.element.removeClass("icon-"+this.options.variant).addClass("icon-"+b),this.options.variant=b}}},a.webos.widget("icon","image"),a.webos.icon._svgFilters={dark:a('<div style="width:0;height:0;overflow:hidden;"><svg height="0" xmlns="http://www.w3.org/2000/svg"><filter id="webos-icon-brightness-darker"><feComponentTransfer><feFuncR type="linear" slope="0.3"/><feFuncG type="linear" slope="0.3"/><feFuncB type="linear" slope="0.3"/></feComponentTransfer></filter></svg></div>').appendTo("body")},a.webos.progressbar=function(b){return a("<div></div>").progressbar({value:b})},a.webos.progressbar.prototype={_name:"progressbar",options:{value:0},_create:function(){this._super("_create"),this.options._content=a("<div></div>").appendTo(this.element),this.element.append(this.content()),this.value(this.options.value)},_update:function(a,b){switch(a){case"value":this.value(b)}},value:function(a){return"undefined"==typeof a?this.options.value:(a=parseInt(a),isNaN(a)&&(a=0),0>a&&(a=0),a>100&&(a=100),this.options.value=a,this.content().css("width",a+"%"),void 0)}},a.webos.widget("progressbar","container"),a.webos.buttonContainer=function(){return a("<div></div>").buttonContainer()},a.webos.buttonContainer.prototype={_name:"button-container"},a.webos.widget("buttonContainer","container"),a.webos.buttonGroup=function(){return a("<div></div>").buttonGroup()},a.webos.buttonGroup.prototype={_name:"button-group"},a.webos.widget("buttonGroup","container"),a.webos.button=function(b,c){return a("<span></span>").button({label:b,submit:c})},a.webos.button.prototype={options:{label:"",icon:void 0,submit:!1,disabled:!1,activated:!1,showIcon:!0,showLabel:!0},_name:"button",_create:function(){this._super("_create"),this.options.label||(this.options.label=this.element.is(":empty")||this.options.label?"Bouton":this.element.html()),this._update("submit",this.options.submit),this._update("label",this.options.label),this._update("disabled",this.options.disabled),this._update("activated",this.options.activated),this._update("icon",this.options.icon),this._update("showLabel",this.options.showLabel),this._update("showIcon",this.options.showIcon)},_update:function(b,c){switch(b){case"submit":var d=function(){a(this).parents("form").first().submit()};c?this.content().click(d):this.content().unbind("click",d),this.element.toggleClass("submit",c?!0:!1);break;case"label":this.content().html(c);break;case"disabled":this.disabled(c);break;case"activated":this.element.toggleClass("active",c?!0:!1);break;case"icon":break;case"showLabel":break;case"showIcon":}},disabled:function(a){return"undefined"==typeof a?this.options.disabled:(this.options.disabled=a?!0:!1,!this.element.is(".disabled")&&this.options.disabled&&this.element.addClass("disabled cursor-default"),this.element.is(".disabled")&&!this.options.disabled&&this.element.removeClass("disabled cursor-default"),void 0)}},a.webos.widget("button","container"),a.webos.list=function(b,c){return a("<div></div>").list({columns:b,buttons:c})},a.webos.list.prototype={options:{columns:[],buttons:[],multipleSelection:!0},_name:"list",_create:function(){this._super("_create"),this.options._components.table=a("<table></table>").appendTo(this.element),this.options._components.head=a("<thead></thead>").appendTo(this.options._components.table),this.options._content=a("<tbody></tbody>").appendTo(this.options._components.table);for(var b=0;b<this.options.columns.length;b++)this.addColumn(this.options.columns[b]);for(var b=0;b<this.options.buttons.length;b++)this.addButton(this.options.buttons[b])},addColumn:function(b){return 0==this.options._components.head.children("tr").length&&this.options._components.head.append(a("<tr></tr>")),a("<td></td>").html(b||"").appendTo(this.options._components.head.children("tr"))},column:function(b,c){var d;return"undefined"==typeof b?d=this.addColumn():(d=a(this.options._components.head.find("td")[b]),0==d.length&&(d=this.addColumn())),"undefined"!=typeof c&&d.html(c),d},sort:function(b,c){b||(b=0);var d=this.content().children(),e=a.makeArray(d);e.sort(function(b,c){b=a(b).text(),c=a(c).text();for(var d,e,f=0;(d=b[f])&&(e=c[f]);f++)if(d!==e){var g=Number(d),h=Number(e);return g==d&&h==e?g-h:d>e?1:-1}return b.length-c.length}),c&&e.reverse();var f=this,g=[];d.each(function(){var b=a(this),c=(b.index(),jQuery.inArray(this,e));b.detach();for(var d=c-1;d>=0;d--)if(-1!=jQuery.inArray(d,g))return b.insertAfter(e[d]),void g.push(c);b.prependTo(f.content()),g.push(c)})},addButton:function(b){"undefined"==typeof this.options._components.buttonContainer&&(this.options._components.buttonContainer=a.w.buttonContainer().appendTo(this.element)),this.options._components.buttonContainer.append(b)},items:function(){return this.content().children()},selection:function(b){if("undefined"==typeof b)return this.items().filter(".active");if("string"==typeof b)if(/^[0-9]+$/.test(b))b=[parseInt(b)];else{if(!/^[0-9]+\-[0-9]+$/.test(b))return!1;var c=/^([0-9]+)-([0-9]+)$/.exec(b);range=[parseInt(c[1]),parseInt(c[2])],range[0]>range[1]&&(range=[range[1],range[0]]),b=[];for(var d=range[0];d<=range[1];d++)b.push(d)}else"number"==typeof b&&(b=[b]);this.items().each(function(){-1!=a.inArray(a(this).index(),b)?a(this).listItem("active",!0):a(this).listItem("active",!1)})},_update:function(a){switch(a){case"columns":this.options._components.head.find("td").remove();for(var b=0;b<this.options.columns.length;b++)this.addColumn(this.options.columns[b]);break;case"buttons":"undefined"!=typeof this.options._components.buttonContainer&&this.options._components.buttonContainer.remove();for(var b=0;b<this.options.buttons.length;b++)this.addButton(this.options.buttons[b])}}},a.webos.widget("list","container"),a.webos.listItem=function(b){return a("<tr></tr>").listItem({columns:b})},a.webos.listItem.prototype={options:{columns:[],active:!1},_name:"list-item",_create:function(){this._super("_create"),this.options.columns instanceof Array||(this.options.columns=[this.options.columns]);for(var b=0;b<this.options.columns.length;b++)this.addColumn(this.options.columns[b]);var c=this;this.options._content.mousedown(function(b){if(a.webos.keyboard.pressed("shift")){var d=c.parentList(),e=c.element.index(),f=d.list("selection"),g=f.first().index(),h=f.last().index(),i=[c.element.index()];i.push(g>e?g:e>h?h:g),d.list("selection",i[0]+"-"+i[1]),b.preventDefault()}else c.active(!0,!a.webos.keyboard.pressed("ctrl"))}),this.active(this.options.active)},addColumn:function(b){var c=a("<td></td>");return"undefined"!=typeof b&&c.html(b),this.content().append(c),c},column:function(b,c){var d;return"undefined"==typeof b?d=this.addColumn():(d=a(this.content().children("td")[b]),0==d.length&&(d=this.addColumn())),"undefined"!=typeof c&&d.html(c),d},active:function(a,b){return"undefined"==typeof a?this.options.active?!0:!1:void(a?((b||!this.parentList().list("option","multipleSelection"))&&this.parentList().list("items").filter(".active").listItem("active",!1),this.options._content.addClass("active").trigger("select"),this._trigger("select")):(this.options._content.removeClass("active").trigger("unselect"),this._trigger("unselect")))},parentList:function(){return this.options._content.parents("table").first().parent()},_update:function(a,b){switch(a){case"active":this.active(b)}}},a.webos.widget("listItem","container"),a.webos.iconsList=function(){return a("<ul></ul>").iconsList()},a.webos.iconsList.prototype={_name:"iconslist"},a.webos.widget("iconsList","container"),a.webos.iconsListItem=function(b,c){return a("<li></li>").iconsListItem({icon:b,title:c})},a.webos.iconsListItem.prototype={options:{icon:"",title:"",active:!1},_name:"iconslistitem",_create:function(){this._super("_create"),this.options._components.icon=a.w.icon().appendTo(this.element),this.options._components.title=a("<span></span>").appendTo(this.element);var b=this;this.element.mousedown(function(){b.active(!0)}),this._setIcon(this.options.icon),this._setTitle(this.options.title),this.active(this.options.active)},_setIcon:function(a){return"undefined"==typeof a?this.options.icon:void this.options._components.icon.icon("option","src",a)},_setTitle:function(b){return"undefined"==typeof b?this.options.title:(""==b?this.element.children("br").remove():a("<br />").insertBefore(this.options._components.title),void this.options._components.title.html(b))},active:function(a){return"undefined"==typeof a?this.options.active?!0:!1:void(a?(this.element.parent().children(".active").iconsListItem("active",!1),this.element.addClass("active")):this.element.removeClass("active"))},_update:function(a,b){switch(a){case"icon":this._setIcon(b);break;case"title":this._setTitle(b);break;case"active":this.active(b)}}},a.webos.widget("iconsListItem","container"),a.webos.iconsListHeader=function(b){return a("<li></li>").iconsListHeader({title:b})},a.webos.iconsListHeader.prototype={options:{title:""},_name:"iconslistheader",_create:function(){this._super("_create"),this.options._components.title=a("<span></span>",{"class":"title"}).appendTo(this.element),this.option("title",this.options.title)},_update:function(a,b){switch(a){case"title":this.options._components.title.html(b)}}},a.webos.widget("iconsListHeader","container"),a.webos.spoiler=function(b){return a("<div></div>").spoiler({label:b})},a.webos.spoiler.prototype={_name:"spoiler",options:{label:"Plus",shown:!1},_create:function(){this._super("_create");var b=this;this.options._components.label=a("<div></div>").addClass("label").html(this.options.label).click(function(){b.toggle()}).appendTo(this.element),this.options._components.arrow=a("<span></span>").addClass("arrow").prependTo(this.options._components.label),this.options._content=a("<div></div>").addClass("content").appendTo(this.element),this.options.shown||this.content().hide()},show:function(){this.content().slideDown(),this.element.addClass("shown"),this.options.shown=!0,this._trigger("show")},hide:function(){this.content().slideUp(),this.element.removeClass("shown"),this.options.shown=!1,this._trigger("hide")},toggle:function(){this.options.shown?this.hide():this.show()},_update:function(b,c){switch(b){case"label":this.options._components.label.html(c),this.options._components.arrow=a("<span></span>").addClass("arrow").prependTo(this.options._components.label);break;case"shown":c?this.show():this.hide()}}},a.webos.widget("spoiler","container"),a.webos.entryContainer=function(){return a("<form></form>").entryContainer()},a.webos.entryContainer.prototype={_name:"entry-container",_create:function(){this._super("_create"),this.element.submit(function(a){a.preventDefault()}),a("<input />",{type:"submit","class":"fake-submit"}).appendTo(this.content())}},a.webos.widget("entryContainer","container"),a.webos.entry=function(){},a.webos.entry.prototype={options:{label:"",value:"",disabled:!1},_name:"entry",_create:function(){this._super("_create");var b=this;this.options._components.label=a("<label></label>").html(this.options.label).click(function(){b.options._content.focus()}),this.element.append(this.options._components.label),this.element.bind("change",function(){b._trigger("change",{type:"change"},{entry:b.element,value:b.value()})})},value:function(a){return"undefined"==typeof a?this.content().val():void(this.value()!=a&&this.content().val(a))},disabled:function(a){return"undefined"==typeof a?this.content().prop("disabled"):(this.options.disabled=a?!0:!1,this.content().prop("disabled",this.options.disabled),this.options.disabled?this.element.addClass("disabled"):this.element.removeClass("disabled"),void 0)},label:function(){return this.options._components.label},input:function(){return this.content()},_update:function(a,b){switch(a){case"label":this.options._components.label.html(b);break;case"disabled":this.disabled(b);break;case"value":this.value(b)}}},a.webos.widget("entry","container"),a.webos.checkableEntry=function(){},a.webos.checkableEntry.prototype={options:{autoCheck:!0,check:null},_name:"checkable-entry",_create:function(){this._super("_create"),this.option("autoCheck",this.options.autoCheck)},_update:function(a,b){switch(this._super(a,b),a){case"autoCheck":if(b){var c=this;this.input().bind("keyup.checkableentry.widget.webos focusout.checkableentry.widget.webos",function(){c.check()})}else this.input().unbind("keyup.checkableentry.widget.webos focusout.checkableentry.widget.webos")}},isValid:function(){return"function"==typeof this.options.check?this.options.check(this.value())?!0:!1:!0},check:function(){var a=null,b=!0;if("function"==typeof this.options.check){var c=this.options.check(this.value());a=String(c)?String(c):null,b=c===!0?!0:!1}return b?this.element.removeClass("error"):this.element.addClass("error"),this._trigger("check",{type:"check"},{valid:b,message:a}),b}},a.webos.widget("checkableEntry","entry"),a.webos.textEntry=function(b,c){return a("<div></div>").textEntry({label:b,value:c})},a.webos.textEntry.prototype={_name:"text-entry",_create:function(){this._super("_create"),this.options._content=a("<input />",{type:"text"}),this.element.append(this.options._content),this.value(this.options.value),this.option("disabled",this.options.disabled)}},a.webos.widget("textEntry","checkableEntry"),a.webos.captchaEntry=function(){return a("<div></div>").captchaEntry()},a.webos.captchaEntry.prototype={_name:"captcha-entry",_create:function(){this._super("_create");var b=this;this.options._components.label=a.webos.label().appendTo(this.element),this.options._components.input=a.webos.textEntry().textEntry("option","check",function(){return b.isValid()}).hide().appendTo(this.element),this.options._components.reload=a.w.button("Recharger").click(function(){b.loadCaptcha()}).appendTo(this.options._components.input),this.loadCaptcha()},loadCaptcha:function(){var b=this;this.options._components.label.html("Chargement..."),this.options._components.reload.button("option","disabled",!0),b.options._content.is("img")&&b.options._content.remove(),new W.ServerCall({"class":"CaptchaController",method:"get"}).load([function(c){var d=c.getData();switch(b.options._captchaId=d.id,d.type){case 1:b.options._components.input.textEntry("option","label",d.captcha);break;case 2:b.options._content=a("<img />",{src:"data:image/png;base64,"+d.captcha,alt:"captcha"}).insertAfter(b.options._components.label),b.options._components.input.textEntry("option","label","Veuillez recopier le texte de l'image ci-dessus : ")}b.options._components.label.hide(),b.options._components.input.show(),b.options._components.reload.button("option","disabled",!1)},function(){b.options._components.label.html("Une erreur est survenue."),b.options._components.reload.button("option","disabled",!1)}])},captchaId:function(){return this.options._captchaId},isValid:function(){return this.options._components.input.textEntry("value").length>0},check:function(){return this.options._components.input.textEntry("check")},value:function(){return this.options._components.input.textEntry("value")}},a.webos.widget("captchaEntry","container"),a.webos.searchEntry=function(b){return a("<div></div>").searchEntry({label:b})},a.webos.searchEntry.prototype={_name:"search-entry",_create:function(){this._super("_create"),this.options._content=a("<input />",{type:"text"}),this.element.append(this.options._content),this.value(this.options.value),this.option("disabled",this.options.disabled)}},a.webos.widget("searchEntry","entry"),a.webos.passwordEntry=function(b){return a("<div></div>").passwordEntry({label:b})},a.webos.passwordEntry.prototype={_name:"password-entry",_create:function(){this._super("_create"),this.options._content=a("<input />",{type:"password"}),this.element.append(this.options._content),this.option("disabled",this.options.disabled)}},a.webos.widget("passwordEntry","checkableEntry"),a.webos.numberEntry=function(b,c,d,e){return a("<div></div>").numberEntry({label:b,value:c,min:d,max:e})},a.webos.numberEntry.prototype={_name:"number-entry",options:{min:null,max:null,step:null},_create:function(){this._super("_create"),this.options._content=a("<input />",{type:"number"}),this.element.append(this.options._content),this.option("min",this.options.min),this.option("max",this.options.max),this.option("step",this.options.step),this.value(this.options.value),this.option("disabled",this.options.disabled)},value:function(a){return"undefined"==typeof a?parseInt(this.content().val()):void(this.value()!=a&&this.content().val(a))},_update:function(a,b){switch(this._super(a,b),a){case"min":case"max":case"step":b||0===b?(b=parseInt(b),this.options[a]=b,this.input().attr(a,b)):(this.options[a]=null,this.input().removeAttr(a))}}},a.webos.widget("numberEntry","checkableEntry"),a.webos.emailEntry=function(b,c){return a("<div></div>").emailEntry({label:b,value:c})},a.webos.emailEntry.prototype={_name:"email-entry",_create:function(){this._super("_create"),this.options._content=a("<input />",{type:"email"}),this.element.append(this.options._content),this.value(this.options.value),this.option("disabled",this.options.disabled)}},a.webos.widget("emailEntry","checkableEntry"),a.webos.textAreaEntry=function(b){return a("<div></div>").textAreaEntry({label:b})},a.webos.textAreaEntry.prototype={_name:"textarea-entry",_create:function(){this._super("_create"),this.options._components.br=a("<br />").appendTo(this.element),this.options._content=a("<textarea></textarea>").appendTo(this.element),this.value(this.options.value),this.option("disabled",this.options.disabled),this.option("label",this.options.label)},_update:function(a,b){switch(this._super(a,b),a){case"label":this.options._components.br.toggle(b?!0:!1)}}},a.webos.widget("textAreaEntry","checkableEntry"),a.webos.checkButton=function(b,c){return a("<div></div>").checkButton({label:b,value:c})},a.webos.checkButton.prototype={_name:"checkbutton",options:{value:!1},_create:function(){this._super("_create");var b=this;this.options._content=a("<input />",{type:"checkbox"}).change(function(){b.options.value=b.value()}),this.element.prepend(this.content()),this.value(this.options.value),this.option("disabled",this.options.disabled),this.label().click(function(){b.options.disabled||b.option("value",!b.options.value)})},value:function(a){return"undefined"==typeof a?this.content().prop("checked"):(this.options.value=a?!0:!1,void(this.value()!=a&&this.content().prop("checked",this.options.value)))}},a.webos.widget("checkButton","entry"),a.webos.radioButtonContainer=function(){return a("<div></div>").radioButtonContainer()},a.webos.radioButtonContainer.prototype={_name:"radiobutton-container"},a.webos.widget("radioButtonContainer","container"),a.webos.radioButton=function(b,c){return a("<div></div>").radioButton({label:b,value:c})},a.webos.radioButton.prototype={_name:"radiobutton",options:{value:!1},_create:function(){this._super("_create"),this.options._content=a("<input />",{type:"radio"}).change(function(){a(this).parents(".webos-radiobutton-container").first().find(":checked").not(this).prop("checked",!1)}),this.element.prepend(this.options._content),this.value(this.options.value),this.option("disabled",this.options.disabled),this.label().click(function(){that.options.disabled||that.option("value",!that.options.value)})},value:function(a){return"undefined"==typeof a?this.content().prop("checked"):(this.options.value=a?!0:!1,void this.content().prop("checked",this.options.value))}},a.webos.widget("radioButton","entry"),a.webos.selectButton=function(b,c){return a("<div></div>").selectButton({label:b,choices:c})},a.webos.selectButton.prototype={options:{choices:{}},_name:"selectbutton",_create:function(){this._super("_create"),this.options._content=a("<select></select>").appendTo(this.element),this._setChoices(this.options.choices),this.value(this.options.value),this.option("disabled",this.options.disabled)},_setChoices:function(b){this.content().empty();for(var c in b)a("<option></option>",{value:c}).html(b[c]).appendTo(this.content())},value:function(a){if("undefined"==typeof a){var b=this.options._content.children("option:selected");return 1==b.length?b.attr("value"):void 0}this.options._content.children('option[value="'+a+'"]').attr("selected","selected")},_update:function(a,b){switch(this._super(a,b),a){case"choices":this._setChoices(b)}}},a.webos.widget("selectButton","entry"),a.webos.switchButton=function(b,c){return a("<div></div>").switchButton({label:b,value:c})},a.webos.switchButton.prototype={options:{value:!1},_name:"switchbutton",_create:function(){this._super("_create");var b=this;this.options._content=a("<div></div>",{"class":"entry off"}).click(function(){b.options.disabled||b._toggle()}).prependTo(this.element),this.options._components.labels=a("<div></div>",{"class":"labels"}).appendTo(this.options._content),this.options._components.on=a("<div></div>",{"class":"label-on"}).html("I").appendTo(this.options._components.labels),this.options._components.off=a("<div></div>",{"class":"label-off"}).html("O").appendTo(this.options._components.labels),this.options._components.slider=a("<div></div>",{"class":"slider"}).appendTo(this.options._content),this.options._components.slider.ui_draggable({containment:"parent",axis:"x",stop:function(a,c){var d=(c.position.left+b.options._components.slider.outerWidth()/2)/b.options._content.innerWidth();b._value(d>.5?!0:!1)}}),this.value(this.options.value),this.option("disabled",this.options.disabled)},_value:function(a){a=a?!0:!1;var b=a!=this.options.value;this.value(a),b&&this._trigger("change",{type:"change"},{entry:this.element,value:a})},value:function(a){return"undefined"==typeof a?this.options.value:(a=a?!0:!1,a?(this.options._content.removeClass("off").addClass("on"),this.element.closest("html").length&&this.element.is(":visible")?this.options._components.slider.animate({left:this.options._content.innerWidth()-this.options._components.slider.outerWidth()},"fast"):this.options._components.slider.css("left","36px")):(this.options._content.removeClass("on").addClass("off"),this.element.closest("html").length&&this.element.is(":visible")?this.options._components.slider.animate({left:0},"fast"):this.options._components.slider.css("left","0px")),a!=this.options.value&&(this.options.value=a),void 0)},toggle:function(){this.value(!this.value())},_toggle:function(){this._value(!this.value())},disabled:function(a){return"undefined"==typeof a?this.options.disabled:(this.options.disabled=a?!0:!1,void this.options._components.slider.ui_draggable(this.options.disabled?"disable":"enable"))}},a.webos.widget("switchButton","entry"),a.webos.menu=function(){},a.webos.menu.prototype={_name:"menu"},a.webos.widget("menu","container"),a.webos.menuItem=function(b,c){return a("<li></li>").menuItem({label:b,separator:c})},a.webos.menuItem.prototype={_name:"menuitem",options:{label:"",disabled:!1,separator:!1},_create:function(){this._super("_create");var b=this,c=this.element.children().detach();this.element.empty(),this.options._components.label=a("<a></a>",{href:"#"}).html(this.options.label).appendTo(this.element),this.options._content=a("<ul></ul>").appendTo(this.element).append(c),this.element.bind("click mouseenter",function(c){if(b.options.disabled&&"click"==c.type)return!1;var d=b.element,e=b.content();if(!d.is(".hover")&&("mouseenter"!=c.type||0!=d.parents(".webos-menuitem").length)){if(e.children().length>0)e.show();else if("click"==c.type)return d.removeClass("hover"),void d.parents(".webos-menuitem ul .webos-menuitem").hide();d.addClass("hover");var f=function(b){a(b.target).parents().filter(d).length>0&&a(b.target).parents().filter(".webos-menuitem").first().children("ul").children().length>0||(e.hide(),d.removeClass("hover"),a(this).unbind("click",f))};a(document).click(f)}}).bind("mouseleave",function(){var a=b.element,c=b.content();0!=a.parents(".webos-menuitem").length&&(a.removeClass("hover"),c.hide())}),this.options._components.label.bind("click",function(a){a.preventDefault()}),this.option("disabled",this.options.disabled),this.option("separator",this.options.separator)},_update:function(a,b){switch(a){case"label":this.options._components.label.html(b);break;case"disabled":b=b?!0:!1,this.options.disabled=b,this.element.toggleClass("disabled",b);break;case"separator":b=b?!0:!1,this.options.separator=b,this.element.toggleClass("separator",b)}}},a.webos.widget("menuItem","container"),a.webos.tabs=function(b){return a("<div></div>").tabs().tabs("setTabs",b)},a.webos.tabs.prototype={_name:"tabs",options:{selectedTab:null},_create:function(){this._super("_create");var b=this,c=0;if(this.element.children("ul").length){this.options._components.tabs=this.element.children("ul").addClass("tabs");var d=this.options._components.tabs.children();d.addClass("tab-btn"),d.filter(".active").length&&(c=d.filter(".active").index())}else this.options._components.tabs=a("<ul></ul>",{"class":"tabs"}).prependTo(this.element);this.element.children(".contents").length?(this.options._components.content=this.element.children(".contents"),this.option("selectedTab",c)):this.options._components.content=a("<div></div>",{"class":"contents"}).appendTo(this.element),this.options._components.tabs.on("click","li.tab-btn",function(){b.option("selectedTab",a(this).index("li.tab-btn"))})},tab:function(b,c,d){var e,f,g;"undefined"==typeof b?e=0:"undefined"==typeof c&&"string"==typeof b?f=b:"undefined"==typeof c?e=b:"undefined"==typeof d&&"string"==typeof b?(f=b,g=c):"undefined"==typeof d?(e=b,g=c):(e=b,f=c,g=d);var h=a(),i=a(),j=this.options._components.tabs.children("li.tab-btn"),k=!1;return"undefined"!=typeof e&&j[e]?(h=a(j[e]),i=a(this.options._components.content.children("div")[e])):(h=a("<li></li>",{"class":"tab-btn"}).appendTo(this.options._components.tabs),i=a("<div></div>").appendTo(this.options._components.content),null===this.options.selectedTab&&(this.options.selectedTab=0,h.addClass("active"),i.addClass("active")),k=!0),"undefined"!=typeof f&&null!==f&&h.html(f),"undefined"!=typeof g&&null!==g&&i.html(g),k&&this._trigger("tabadd",{type:"tabadd"},{content:i,index:e}),i},removeTab:function(b){var c=a(this.options._components.tabs.children("li.tab-btn")[b]);$tabContents=a(this.options._components.content.children("div")[b]),c.remove(),$tabContents.detach(),this._trigger("tabremove",{type:"tabremove"},{content:$tabContents,index:b}),this._update("selectedTab",0)
},tabIndexFromContent:function(a){var b=this.options._components.content.children().filter(a);return b.length?b.index():!1},countTabs:function(){return this.options._components.content.children().length},setTabs:function(a){var b=0;for(var c in a)this.tab(b,c,a[c]),b++},_update:function(b,c){switch(b){case"selectedTab":"number"!=typeof c&&(c=this.tabIndexFromContent(c));var d=parseInt(c);isNaN(d)&&(d=0);var e=this.options._components.tabs.children("li.tab-btn");if(!e[d])return;e.filter(".active").removeClass("active"),this.options._components.content.children("div.active").removeClass("active"),a(e[d]).addClass("active"),this.tab(d).addClass("active"),this._trigger("select",{type:"select"},{content:this.tab(d),index:d})}}},a.webos.widget("tabs","container"),a.webos.notebook=function(b){return a("<div></div>").notebook().notebook("setTabs",b)},a.webos.notebook.prototype={_name:"notebook"},a.webos.widget("notebook","tabs"),a.webos.dynamicNotebook=function(b){return a("<div></div>").dynamicNotebook().dynamicNotebook("setTabs",b)},a.webos.dynamicNotebook.prototype={_create:function(){this._super("_create");var b=this,c=a("<li></li>",{"class":"tab-btn-newtab"}).html("+").click(function(){b._trigger("newtab")});this.options._components.tabs.append(c)},tab:function(b,c,d){var e=this,f=this._super(b,c,d),g=f.index(),h=a(this.options._components.tabs.children("li.tab-btn")[g]);return h.children(".tab-btn-close").length||($closeBtn=a("<span></span>",{"class":"tab-btn-close"}).html("&times;").click(function(){e.removeTab(f.index())}),h.prepend($closeBtn)),f}},a.webos.widget("dynamicNotebook","notebook"),a.webos.popover=function(b,c){var d=a("<div></div>").popover();return d.popover("component","toggle").html(b||""),d.popover("content").html(c||""),d},a.webos.popover.prototype={_name:"popover",options:{trigger:"click"},_create:function(){this._super("_create");var b=this.element.children(".popover-toggle");b.length||(b=a("<div></div>",{"class":"popover-toggle"}).prependTo(this.element)),this.options._components.toggle=b;var c=this.element.children(".popover-content");c.length||(c=a("<div></div>",{"class":"popover-content"}).appendTo(this.element)),this.options._components.content=c,this._update("trigger",this.options.trigger)},show:function(){this.options._components.content.stop().fadeIn("fast")},hide:function(){this.options._components.content.stop().fadeOut("fast")},toggle:function(){this.options._components.content.stop().fadeToggle("fast")},_update:function(a,b){var c=this;switch(a){case"trigger":b=String(b),this.options._components.toggle.off(".toggle.popover.gtk").on(b+".toggle.popover.gtk",function(){c.toggle()}),this.options.trigger=b}}},a.webos.widget("popover","container"),a.webos.alertContainer=function(b){var c=a("<div></div>").alertContainer();return c.alertContainer("content").html(b||""),c},a.webos.alertContainer.prototype={_name:"alert-container"},a.webos.widget("alertContainer","container"),a.webos.draggable=function(){},a.webos.draggable.prototype={_name:"draggable",options:{data:null,dataType:null,sourceFile:null,dragImage:a(),revert:!0,iframeFix:!1,distance:5},_create:function(){this._super("_create");var b=this;this.element.bind("mousedown.draggable.widget.webos",function(c){if(1!=c.button&&2!=c.button){var d,e,f;if(b.options.dragImage&&a(b.options.dragImage).length>0){0==a(b.options.dragImage).closest("html").length&&a(b.options.dragImage).appendTo("body"),d=a(b.options.dragImage)[0],d.style.position="absolute";var g=a(d).width(),h=a(d).height();e=g/2,f=h/2,a(d).css({left:c.pageX-e,top:c.pageY-f}).hide()}else{d=b.element[0],d.style.position="relative";var i=parseInt(b.element.css("left").replace("px","")),j=parseInt(b.element.css("top").replace("px",""));isNaN(i)&&(i=0),isNaN(j)&&(j=0),e=c.pageX-(b.element.parent().offset().left+i),f=c.pageY-(b.element.parent().offset().top+j)}var k=a(d).css("z-index"),l=0,m=!1,n=c.pageX-e,o=c.pageY-f;a(document).bind("mousemove.drag.draggable.widget.webos",function(c){m&&(n=c.pageX-e,o=c.pageY-f,d.style.left=n+"px",d.style.top=o+"px",a.webos.ddmanager.drag(b,c),c.preventDefault())}).on("mousemove.dragstart.draggable.widget.webos",function(c){if(l++,!(l<b.options.distance)){if(a(this).off("mousemove.dragstart.draggable.widget.webos"),l=0,b._trigger("start",c)===!1)return void a(this).trigger("mouseup");b._dragStart(d,c),m=!0}}).one("mouseup",function(c){a(this).unbind("mousemove.drag.draggable.widget.webos").unbind("mousemove.dragstart.draggable.widget.webos"),a(d).removeClass("dragging cursor-move").css("z-index",k),b.options.dragImage&&a(b.options.dragImage).length>0?a(b.options.dragImage).detach():b.options.revert&&a(d).css({left:i,top:j}),a.webos.ddmanager.dragStop(b,c),b._trigger("stop",c),a.webos.ddmanager.drop(b,c),c.preventDefault()}),a.webos.ddmanager.prepareOffsets(b,c),c.preventDefault()}})},_dragStart:function(b,c){a.webos.ddmanager.current=this,a.webos.ddmanager.dragStart(this,c),a(this.options.iframeFix===!0?"iframe":this.options.iframeFix).each(function(){a('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(a(this).offset()).appendTo("body")}),a(b).css("z-index",1e5).addClass("dragging cursor-move"),this.options.dragImage&&a(this.options.dragImage).length>0&&a(this.options.dragImage).show()}},a.webos.widget("draggable","widget"),a.widget.bridge("ui_draggable",a.ui.draggable),a.webos.droppable=function(){},a.webos.droppable.prototype={_name:"droppable",options:{accept:null},_create:function(){this._super("_create");a.webos.ddmanager.droppables.push(this)},destroy:function(){for(var b=0;b<a.webos.ddmanager.droppables.length;b++)a.webos.ddmanager.droppables[b]==this&&a.webos.ddmanager.droppables.splice(b,1)},_activate:function(b){var c=a.webos.ddmanager.current;c&&this._trigger("activate",b,{draggable:c.element,droppable:this.element})},_deactivate:function(b){var c=a.webos.ddmanager.current;c&&this._trigger("deactivate",b,{draggable:c.element,droppable:this.element})},_over:function(b){var c=a.webos.ddmanager.current;c&&this._trigger("over",b,{draggable:c.element,droppable:this.element})},_out:function(b){var c=a.webos.ddmanager.current;c&&this._trigger("out",b,{draggable:c.element,droppable:this.element})},_drop:function(b){var c=a.webos.ddmanager.current;c&&this._trigger("drop",b,{draggable:c.element,droppable:this.element})},accept:function(a){return this.options.accept?a.draggable("option","dataType")?a.draggable("option","dataType")==this.options.accept:!0:!0}},a.webos.widget("droppable","widget"),a.webos.ddmanager={current:null,droppables:[],prepareOffsets:function(b,c){var d=a.webos.ddmanager.droppables,e=c?c.type:null,f=(b.currentItem||b.element).find(":data(droppable)").andSelf();a:for(var g=0;g<d.length;g++)if(!(d[g].options.disabled||b&&!d[g].accept.call(d[g],b.currentItem||b.element)||d[g].element.is(b.currentItem||b.element))){for(var h=0;h<f.length;h++)if(f[h]==d[g]){d[g].proportions.height=0;continue a}d[g].visible="none"!=d[g].element.css("display"),d[g].visible&&("mousedown"==e&&d[g]._activate.call(d[g],c),d[g].offset=d[g].element.offset(),d[g].proportions={width:d[g].element[0].offsetWidth,height:d[g].element[0].offsetHeight},d[g].isover=0)}},drop:function(b,c){var d=!1;return a.each(a.webos.ddmanager.droppables,function(){if(this.options&&!this.options.disabled&&this.visible&&!this.element.is(b.currentItem||b.element)){var a=c.pageX>this.offset.left&&c.pageY>this.offset.top&&c.pageX<this.offset.left+this.proportions.width&&c.pageY<this.offset.top+this.proportions.height;a&&(d=this._drop.call(this,c)||d),this.accept.call(this,b.currentItem||b.element)&&(this.isout=1,this.isover=0,this._deactivate.call(this,c))}}),d},dragStart:function(a,b){a.element.trigger("dragstart",b)},drag:function(b,c){b.options.refreshPositions&&a.webos.ddmanager.prepareOffsets(b,c),a.each(a.webos.ddmanager.droppables,function(){if(!this.options.disabled&&this.visible){var a=c.pageX>this.offset.left&&c.pageY>this.offset.top&&c.pageX<this.offset.left+this.proportions.width&&c.pageY<this.offset.top+this.proportions.height,b=a||1!=this.isover?a&&0==this.isover?"isover":null:"isout";b&&(this[b]=1,this["isout"==b?"isover":"isout"]=0,this["isover"==b?"_over":"_out"].call(this,c))}})},dragStop:function(b,c){b.options.refreshPositions||a.webos.ddmanager.prepareOffsets(b,c),b.element.trigger("dragstop",c)}},a.webos.keyboard={},a.webos.keyboard.systemKey="shift",a.webos.keyboard.keycodes={down:40,up:38,left:37,right:39,end:35,begin:36,backTab:8,tab:9,shift:16,ctrl:17,enter:13,esc:27,space:32,del:46,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119},a.webos.keyboard._keys=[],a(document).keydown(function(b){-1==jQuery.inArray(b.keyCode,a.webos.keyboard._keys)&&a.webos.keyboard._keys.push(b.keyCode)}).keyup(function(b){var c=jQuery.inArray(b.keyCode,a.webos.keyboard._keys);-1!=c&&delete a.webos.keyboard._keys[c]}),a.webos.keyboard.pressed=function(b){if("undefined"==typeof b)return a.webos.keyboard._keys;"string"==typeof b&&(b=b.toLowerCase().split("+")),"object"!=typeof b&&(b=[b]);for(var c=0;c<b.length;c++)if(-1==jQuery.inArray(a.webos.keyboard.name2Keycode(b[c]),a.webos.keyboard._keys))return!1;return!0},a.webos.keyboard.systemKeyDown=function(){return a.webos.keyboard.pressed(a.webos.keyboard.systemKey)},a.webos.keyboard.keycode2Name=function(b){for(var c in a.webos.keyboard.keycodes)if(b===a.webos.keyboard.keycodes[c])return c;return b},a.webos.keyboard.name2Keycode=function(b){return b=b.toLowerCase(),"undefined"!=typeof a.webos.keyboard.keycodes[b]?a.webos.keyboard.keycodes[b]:b},a.webos.keyboard.bind=function(b,c,d){b=a(b),a(document).keydown(function(e){if(a.webos.keyboard.pressed(c)){var f=b,g=!0;b.is(".webos-window")||b.parents().filter(".webos-window").length>0?(b.is(".webos-window")||(f=b.parents().filter(".webos-window").last()),g=f.window("is","foreground")):(b.is("#desktop")||b.parents().filter("#desktop").length>0)&&(b.is("#desktop")||(f=b.parents().filter("#desktop").last()),g="undefined"==typeof a.webos.window.getActive()),e.isFocused=!1,a(e.target).is("input,textarea,select,*:focus")&&(e.isFocused=!0),g&&(e.isFocused||e.preventDefault(),d(e))}})},a.webos.keyboard.keycodes.system=a.webos.keyboard.name2Keycode(a.webos.keyboard.systemKey),a.w=a.webos}(jQuery),function(a){a.webos.widget("window","container",{_name:"window",options:{title:"Fen&ecirc;tre",icon:void 0,resizable:!0,closeable:!0,maximizable:!0,hideable:!0,opened:!1,maximized:!1,parentWindow:a(),childWindow:a(),dialog:!1,badge:0},_create:function(){this._super("_create");var b=this;this.options.states={};for(var c=0;c<a.webos.window.states.length;c++)this.options.states[a.webos.window.states[c][0]]=!1;"undefined"!=typeof this.options.parentWindow&&this.options.parentWindow.length>0&&this.options.parentWindow.window("option","childWindow",this.element),this._setOption("icon",this.options.icon),0==this.options.resizable&&(this.options.maximizable=!1),"undefined"!=typeof this.options.stylesheet&&this.stylesheet(this.options.stylesheet);var d=this.element.children(),e=d.filter("h1");e.length&&(this.options.title=e.text(),e.remove());var f=a(),g=d.filter("header");g.length&&(f=g.children().detach(),e.remove());var h=this.element.contents().detach();this.element.empty().css("position","absolute").mousedown(function(){b.toForeground()}).focus(function(c){b._focus=a(c.target)}).hide(),this.options._components.header=a("<div></div>",{"class":"header"}).appendTo(this.element);var i=a("<div></div>").addClass("top").dblclick(function(){b.minimizeOrMaximize()}).appendTo(this.options._components.header);this.options._components.controllers={};var j=a("<div></div>",{"class":"controllers"}).appendTo(i);this.options._components.controllers.close=a("<span></span>",{"class":"close"}).click(function(){b.close()}).appendTo(j),this.options._components.controllers.hide=a("<span></span>",{"class":"hide"}).click(function(){b.hide()}).appendTo(j),this.options._components.controllers.maximize=a("<span></span>",{"class":"maximize"}).click(function(){b.minimizeOrMaximize()}).appendTo(j),0==this.options.closeable&&this.closeable(!1),0==this.options.hideable&&this.hideable(!1),0==this.options.maximizable&&this.maximizable(!1),this.options._components.title=a("<div></div>",{"class":"title"}).mousedown(function(a){a.preventDefault()}).appendTo(i),this.options._components.specificHeader=a("<div></div>",{"class":"header-specific"}).appendTo(this.options._components.header),f.length&&f.appendTo(this.header()),this.options._content=a("<div></div>",{"class":"content"}).html(h).appendTo(this.element),this.option("title",this.options.title),void 0!=this.options.width&&this.setWidth(this.options.width),void 0!=this.options.height&&this.setHeight(this.options.height),this.options.left&&this.option("left",this.options.left),this.options.top&&this.option("top",this.options.top),"undefined"==typeof this.options.workspace&&a.w.window.workspace&&(this.options.workspace=a.w.window.workspace.getCurrent()),this.dialog(this.options.dialog),this.draggable(!0),this.option("resizable","undefined"==typeof this.options.resizable?!0:this.options.resizable)},_update:function(a,b){switch(a){case"icon":this.options.icon=/^(https?)?\:\/\//.test(b)?{realpath:function(){return b}}:W.Icon.toIcon(b);break;case"title":this.options._components.title.html(b),this._trigger("changetitle",{type:"changetitle"},{title:b});break;case"resizable":this.resizable(b);break;case"stylesheet":this.stylesheet(b);break;case"width":this.setWidth(b);break;case"height":this.setHeight(b);break;case"left":this.element.css("left",b);break;case"top":this.element.css("top",b);break;case"dialog":this.dialog(b);break;case"badge":return void this._trigger("badge",parseInt(b)||0)}},destroy:function(){return this.is("closed")?(this._super("destroy"),void this.element.empty().remove()):(this._trigger("beforeclose",{type:"beforeclose"},{window:this.element}),this._trigger("close",{type:"close"},{window:this.element}),this.options.states.opened=!1,"undefined"!=typeof this.options.childWindow&&this.options.childWindow.length>0&&this.options.childWindow.window("destroy"),"undefined"!=typeof this.options.parentWindow&&this.options.parentWindow.length>0&&this.options.parentWindow.window("option","childWindow",[]),this._super("destroy"),this.element.empty().remove(),void("undefined"!=typeof a.webos.window.getActive()&&a.webos.window.getActive().window("toForeground")))},open:function(){var b=this;if(!this.is("opened")&&this._trigger("beforeopen",{type:"beforeopen"},{window:this.element})!==!1){if(this.element.appendTo("#desktop"),this._trigger("open",{type:"open"},{window:this.element}),a.w.window.workspace&&this.options.workspace.id()!=a.w.window.workspace.getCurrent().id()||this.element.css({opacity:0,scale:.9,display:"block"}).animate({opacity:1,scale:1},"fast",function(){b._trigger("afteropen",{type:"afteropen"},{window:b.element})}),1==this.options.maximized){var c={animate:!1};this.options.maximizedDisplay&&(c=a.extend({},this.options.maximizedDisplay,c)),this.maximize(c)}else this.options.top||this.options.left||this.center();this._saveDimentions(),this.options.states.opened=!0,a.w.window.workspace&&this.options.workspace.id()!=a.w.window.workspace.getCurrent().id()?b._trigger("afteropen",{type:"afteropen"},{window:b.element}):this.toForeground()}},close:function(){var b=this;this.is("closed")||this._trigger("beforeclose",{type:"beforeclose"},{window:this.element})!==!1&&(this.element.addClass("closing"),this.options.states.opened=!1,this.options.states.foreground=!1,this._trigger("close",{type:"close"},{window:this.element}),"undefined"!=typeof this.options.childWindow&&this.options.childWindow.length>0&&(this.options.childWindow.window("close"),this.options.childWindow=[]),"undefined"!=typeof this.options.parentWindow&&this.options.parentWindow.length>0&&this.options.parentWindow.window("option","childWindow",[]),this.element.animate({opacity:0,scale:.9},"fast",function(){b._trigger("afterclose",{type:"afterclose"},{window:b.element}),a(this).removeClass("closing").detach();var c=a.webos.window.getActive();c&&c.length&&c.window("toForeground")}))},maximize:function(){if(!this.is("maximized")&&this.options.maximizable){this.is("opened")&&this._saveDimentions();var b=a("#desktop"),c=b.height(),d=b.width(),e={animate:!0,mode:"full",position:"left"};"object"==typeof arguments[0]?a.extend(e,arguments[0]):"undefined"!=typeof arguments[0]&&(e.animate=arguments[0]?!0:!1);var f="fast";e.animate||(f=0);var g={};g="half"==e.mode?"right"==e.position?{width:d/2,height:c,top:0,left:d/2}:{width:d/2,height:c,top:0,left:0}:{width:d,height:c,top:0,left:0},this.options.maximizedDisplay={mode:e.mode,position:e.position},this.options._maximizedPosition={left:g.left,top:g.top},this.options._maximizedDimentions={width:g.width,height:g.height},this.element.addClass("animating").animate(g,f);var h=this;this.options._content.animate({width:g.width,height:g.height-h.options._components.header.outerHeight(!0)},f,function(){h.element.addClass("maximized").removeClass("animating"),h.options.states.maximized=!0,h._trigger("maximize",{type:"maximize"},{window:h.element}),h._trigger("resize",{type:"resize"},{window:h.element}),h._trigger("move",{type:"resize"})}),this.options.resizable&&this.element.resizable("disable"),this.element.children(".title-window").css("cursor","auto")}},remaximize:function(b){if(this.is("maximized")&&this.options.maximizable){var c=a("#desktop"),d=c.height(),e=c.width(),f={animate:"undefined"==typeof b||b?!0:!1,mode:"full",position:"left"};a.extend(f,this.options.maximizedDisplay);var g="fast";f.animate||(g=0);var h={};h="half"==f.mode?"right"==f.position?{width:e/2,height:d,top:0,left:e/2}:{width:e/2,height:d,top:0,left:0}:{width:e,height:d,top:0,left:0},this.options._maximizedPosition={left:h.left,top:h.top},this.options._maximizedDimentions={width:h.width,height:h.height},this.element.addClass("animating").animate(h,g);var i=this;this.options._content.animate({width:h.width,height:h.height-i.options._components.header.outerHeight(!0)},g,function(){i.element.removeClass("animating"),i._trigger("resize",{type:"resize"},{window:i.element}),i._trigger("move",{type:"resize"})})}},minimize:function(a){if(!this.is("minimized")&&1==this.options.maximizable){var b=this.options._dimentions,c=this.options._position,d=this,e="fast";0==a&&(e=0),this.options._content.animate({width:b.width,height:d.options._dimentions.height-d.options._components.header.height()},e),this.element.addClass("animating").animate({width:b.width,height:b.height,top:c.top,left:c.left},e,function(){d._saveDimentions(),d.element.removeClass("animating").removeClass("maximized"),d._trigger("minimize",{type:"minimize"},{window:d.element}),d.options.states.maximized=!1,d._trigger("resize",{type:"resize"},{window:d.element}),d._trigger("move",{type:"resize"})}),this.options.resizable&&this.element.resizable("enable"),this.element.children(".title-window").css("cursor","move")}},minimizeOrMaximize:function(){this.is("maximized")?this.minimize():this.maximize()},maximizedDisplay:function(){return this.options.maximizedDisplay},hide:function(){if(!this.is("hidden")){this._saveDimentions();var b=a.webos.window.getHidePos(this.element),c=this;this.element.addClass("hidden-window").removeClass("bg-window").animate({opacity:0,width:0,height:0,top:b.top,left:b.left},{duration:"fast",complete:function(){a(this).css("display","none"),c.toBackground();var b=a.webos.window.getActive();"undefined"!=typeof b&&b.window("toForeground"),c._trigger("hide",{type:"hide"},{window:c.element}),c.options.states.hidden=!0},queue:!1}),"undefined"!=typeof this.options.childWindow&&this.options.childWindow.length>0&&this.options.childWindow.is(":visible:not(:animated)")&&this.options.childWindow.window("hide"),"undefined"!=typeof this.options.parentWindow&&this.options.parentWindow.length>0&&this.options.parentWindow.is(":visible:not(:animated)")&&this.options.parentWindow.window("hide")}},show:function(){if(!this.is("visible")){"undefined"!=typeof this.options.parentWindow&&this.options.parentWindow.length>0&&this.options.parentWindow.is(":hidden:not(:animated)")&&this.options.parentWindow.window("show");var a,b;this.is("maximized")?(a=this.options._maximizedPosition,b=this.options._maximizedDimentions):(a=this.options._position,b=this.options._dimentions);var c=this;this.element.css("display","block").removeClass("hidden-window").animate({width:b.width,height:b.height,top:a.top,left:a.left,opacity:1},{duration:"fast",complete:function(){c._trigger("show",{type:"show"},{window:c.element}),c.options.states.hidden=!1},queue:!1}),this.toForeground(),"undefined"!=typeof this.options.childWindow&&typeof this.options.childWindow.length>0&&this.options.childWindow.is(":hidden:not(:animated)")&&this.options.childWindow.window("show")}},hideOrShow:function(){this.is("hidden")?this.show():this.hide()},toForeground:function(){a.webos.window.allToBackGroundExcluding(this.element),this.is("foreground")||(this.element.css("z-index",a.webos.window.requestZIndex()),this._restoreFocus(),this.element.removeClass("bg-window"),this._trigger("toforeground",{type:"toforeground"},{window:this.element}),this.options.states.foreground=!0,"undefined"!=typeof this.options.childWindow&&this.options.childWindow.length>0&&this.options.childWindow.window("toForeground"))},toBackground:function(){this.is("background")||(this.element.addClass("bg-window"),this._trigger("tobackground",{type:"tobackground"},{window:this.element}),this.options.states.foreground=!1)},hideOrShowOrToForeground:function(){this.is("visible")?this.is("background")?this.toForeground():this.hide():this.show()},states:function(){return this.options.states},is:function(b){if("undefined"!=typeof this.options.states[b])return this.options.states[b];for(var c=0;c<a.webos.window.states.length;c++)if(a.webos.window.states[c][1]==b)return!this.options.states[a.webos.window.states[c][0]];return!1},_saveDimentions:function(){return this.is("maximized")?(this.options._dimentions||(this.options._dimentions={width:this.options.width?this.options.width:100,height:this.options.height?this.options.height:100}),void(this.options._position||(this.options._position={top:this.options.top?this.options.top:(a("#desktop").height()-this.options._dimentions.height)/2,left:this.options.left?this.options.left:(a("#desktop").width()-this.options._dimentions.width)/2}))):(this.options._dimentions={},this.options._dimentions.width=this.element.width(),this.options._dimentions.height=this.element.height(),void(this.options._position=this.element.position()))},cachedDimentions:function(){return this.options._dimentions},dimentions:function(){return this.is("maximized")?this.options._maximizedDimentions:this.options._dimentions},contentDimentions:function(){var b=a.extend({},this.dimentions());return b.height-=this.options._components.header.outerHeight(!0),b},contentCachedDimentions:function(){var b=a.extend({},this.cachedDimentions());return b.height-=this.options._components.header.outerHeight(!0),b},position:function(){return this.is("maximized")?this.options._maximizedPosition:this.options._position},_restoreFocus:function(){"undefined"!=typeof this.options._focus&&this.options._focus.focus()},header:function(){return this.options._components.specificHeader},center:function(){var b={top:(a("#desktop").height()-this.element.outerHeight())/2,left:(a("#desktop").width()-this.element.outerWidth())/2};b.top=b.top<0?0:b.top,b.left=b.left<0?0:b.left,this.option({left:b.left,top:b.top})},setWidth:function(a){0!=a&&(this.element.width(a),this.options._content.width(this.element.innerWidth()))},setHeight:function(a){0!=a&&this.options._content.height(a)},loading:function(b,c){if(b){var d=a.extend({message:"Loading...",lock:!0,progress:null},c);if("number"==typeof d.progress?(d.progress>100&&(d.progress=100),d.progress<0&&(d.progress=0)):d.progress=null,this.options.loading=d,d.lock){if(!this.is("loading")){var e=this.options._content.outerWidth(!0),f=this.options._content.outerHeight(!0);this.options._content.hide(),this.options._loadingContent=a("<div></div>",{"class":"content loading cursor-wait"}).width(e).height(f).css("min-height","50px").css("min-width","50px").insertAfter(this.options._content);{var g=a("<div></div>",{"class":"message-container"}).appendTo(this.options._loadingContent);a("<div></div>",{"class":"message"}).appendTo(g)}this.options.resizable&&this.element.resizable("option","alsoResize",this.options._loadingContent)}this.options._loadingContent.find(".message").html(d.message)}else this.options._loadingContent&&(this.options._loadingContent.remove(),this.options._content.show());this._trigger("loadingstart"),"number"==typeof d.progress&&this._trigger("progress",{type:"progress"},{value:d.progress}),this.options.states.loading=!0}else{if(this.is("ready"))return;this.options.loading.lock&&(a(this.options._loadingContent).remove(),delete this.options._loadingContent,this.options._content.show().addClass("content"),this.options.resizable&&this.element.css("width","auto").css("height","auto").resizable("option","alsoResize",this.options._content)),this.options.states.loading=!1,this._trigger("loadingstop"),"number"==typeof this.options.loading.progress&&(this.options.loading.progress=100,this._trigger("progress",{type:"progress"},{value:100}))}},_protectIframes:function(b){if(b||"undefined"==typeof b){var c=a();this.element.find("iframe").each(function(){var b=a(this).position();c=c.add(a("<div></div>").css({position:"absolute",top:b.top,left:b.left,width:a(this).outerWidth(),height:a(this).outerHeight()}).insertAfter(this))}),this.options._components.iframesOverlays=c}else this.options._components.iframesOverlays&&(this.options._components.iframesOverlays.remove(),this.options._components.iframesOverlays=null)},resizable:function(a){if(this.options.resizable=a?!0:!1,!this.options.resizable&&this.options.maximizable&&this.maximizable(!1),this.options.resizable){var b=this;this.element.resizable({alsoResize:this.options._content,minWidth:200,minHeight:150,handles:"all",start:function(){b.element.addClass("resizing"),b._protectIframes()},stop:function(){b._saveDimentions(),b.element.removeClass("resizing"),b._protectIframes(!1);var a=b.contentCachedDimentions();b.options._content.css(a),b._trigger("resize",{type:"resize"},{window:b.element})}})}else this.element.is(":ui-resizable")&&this.element.resizable("destroy")},draggable:function(){var b=this;this.options._components.header.bind("mousedown.window.widget.webos",function(c){if(!a(c.target).add(a(c.target).parents()).is(".controllers *, .header-specific * *")){b._protectIframes();var d=b.element[0],e=b.element.position().left,f=b.element.position().top,g=c.pageX-e,h=c.pageY-f,i=a("#desktop").position().left,j=a("#desktop").position().top,k=a("#desktop").outerWidth(),l=!1,m=null,n=null,o=a(),p=function(c,d){if(!l&&b.options.maximizable){c=c||"full",d=d||"left",m=c,n=d;var e={},f={};"half"==c?"right"==d?(e={top:"12.5%",right:0,width:"37.5%",height:"75%"},f={width:"50%",height:"100%",top:0}):(e={top:"12.5%",left:0,width:"37.5%",height:"75%"},f={width:"50%",height:"100%",top:0}):(e={top:0,left:"12.5%",width:"75%",height:"75%"},f={width:"100%",height:"100%",left:0}),a.extend(e,{position:"absolute",opacity:0,"z-index":b.element.css("z-index")}),a.extend(f,{opacity:1}),o=a("<div></div>").addClass("webos-window-manip-helper").css(e).insertBefore(b.element).animate(f),l=!0}},q=function(){l&&b.options.maximizable&&(o.stop().fadeOut("normal",function(){a(this).remove()}),o=a(),l=!1)};if(b.is("maximized")){var r=g/b.element.outerWidth(!0);a("body").one("mousemove.maximized.window.widget.webos",function(a){b.minimize(!1),e=a.pageX-r*b.element.outerWidth(!0),f=a.pageY-h,b.element.css({left:e,top:f}),g=a.pageX-e,h=a.pageY-f}).one("mouseup",function(){a("body").unbind("mousemove.maximized.window.widget.webos")})}a("body").bind("mousemove.window.widget.webos",function(a){e=a.pageX-g,f=a.pageY-h,0>f&&(f=0),d.style.left=e+"px",d.style.top=f+"px",a.pageY-j<=0?p():a.pageX-i<=0?p("half"):a.pageX-i-k+1>=0?p("half","right"):q(),a.preventDefault()}).one("mouseup",function(c){a(this).unbind("mousemove.window.widget.webos");var d=a("#desktop").offset(),g=d.left,h=d.top;if(e+b.element.width()<g&&b.element.css("left",0),e>g+a("#desktop").outerWidth()&&b.element.css("left",a("#desktop").width()-b.element.width()),f>h+a("#desktop").outerHeight()){var i=a("#desktop").height()-b.element.outerHeight();0>i&&(i=0),b.element.css("top",i)}b.element.removeClass("dragging cursor-move"),b._protectIframes(!1),b._saveDimentions(),l&&(b.maximize({mode:m,position:n}),q()),b.option({left:e,top:f}),b._trigger("move"),c.preventDefault()}),b.element.addClass("dragging cursor-move"),c.preventDefault()}})},workspace:function(a){return"undefined"==typeof a?this.options.workspace:void(this.options.workspace=a)},closeable:function(a){return"undefined"==typeof a?this.options.closeable:(this.options.closeable=a?!0:!1,void(this.options.closeable?this.element.removeClass("not-closeable"):this.element.addClass("not-closeable")))},hideable:function(a){return"undefined"==typeof a?this.options.hideable:(this.options.hideable=a?!0:!1,void(this.options.hideable?this.element.removeClass("not-hideable"):this.element.addClass("not-hideable")))},maximizable:function(a){return"undefined"==typeof a?this.options.maximizable:(this.options.maximizable=a?!0:!1,void(this.options.maximizable?this.element.removeClass("not-maximizable"):this.element.addClass("not-maximizable")))},stylesheet:function(a){if("undefined"==typeof a)return this.options.stylesheet;var b=this;Webos.require(a,function(){b._trigger("stylesheetload",{type:"stylesheetload"},{window:b.element})},{styleContainer:this.selector()})},dialog:function(a){return"undefined"==typeof a?this.element.is(".dialog"):void this.element.toggleClass("dialog",a)}}),a.webos.window=function(b){return a("<div></div>").window(b)},a.webos.window.states=[["opened","closed"],["foreground","background"],["hidden","visible"],["maximized","minimized"],["loading","ready"]],a.webos.subwidget("window","main",function(b,c){var d=b[0];if(c.window("option",d),c.one("windowafterclose",function(){if("number"==typeof a(this).window("pid")){var b=Webos.Process.get(a(this).window("pid"));b&&b.stop()}}),"number"==typeof c.window("pid")){var e=Webos.Process.get(c.window("pid"));if(e.on("stop",function(){c.window("is","closed")||c.window("close")}),Webos.isInstanceOf(e,Webos.Cmd)){var f=(a.webos.window.main._list.push(c[0])-1,a.webos.window.main._cache[e.cmd]);if(f){var d={top:f.position.top,left:f.position.left,maximized:f.states.maximized,maximizedDisplay:f.maximizedDisplay};if("number"==typeof f.dimentions.width&&(d.width=f.dimentions.width),"number"==typeof f.dimentions.height&&(d.height=f.dimentions.height),"number"==typeof f.workspace&&a.w.window.workspace){var g=a.w.window.workspace.get(f.workspace);g&&(d.workspace=g)}c.window("option",d)}c.bind("windowbeforeclose",function(){a.webos.window.main._cache[e.cmd]=a.webos.window.main._getWindowDisplay(c)})}}return c}),a.webos.window.main._list=[],a.webos.window.main._cache={},a.webos.window.main._getWindowDisplay=function(a){var b={position:a.window("position"),dimentions:{},states:a.window("states"),workspace:a.window("option","workspace")?a.window("option","workspace").id():void 0};return a.window("option","resizable")&&(b.dimentions=a.window("contentCachedDimentions")),a.window("option","maximizable")&&(b.maximizedDisplay=a.window("is","maximized")?a.window("maximizedDisplay"):null),b},a.webos.window.main.list=function(){return a.webos.widget.filter(a(a.webos.window.main._list),"window")},a.webos.window.main.windowsDisplay=function(b){if("undefined"==typeof b){var b=a.extend({},a.webos.window.main._cache),c=a.webos.window.main.list();
return c.each(function(){var c=a(this);if(c.length&&a.webos.widget.is(c,"window")&&c.window("is","opened")&&"number"==typeof c.window("pid")){var d=Webos.Process.get(c.window("pid"));Webos.isInstanceOf(d,Webos.Cmd)&&(b[d.cmd]=a.webos.window.main._getWindowDisplay(c))}}),b}a.webos.window.main._cache=b},a.webos.window.about=function(b){var c={parentWindow:a.webos.window.getActive(),name:"Programme",version:"",description:"",author:"la communaut&eacute;"},d=a.extend(c,b),e=a.webos.window({parentWindow:d.parentWindow,title:"&Agrave; propos de "+d.name,icon:d.icon,resizable:!1,hideable:!1,width:400,stylesheet:"/usr/share/css/gnome/aboutwindow.css"}),f=e.window("content");"undefined"!=typeof d.icon&&a("<img />",{"class":"icon"}).attr("src",W.Icon.toIcon(d.icon).realpath(64)).appendTo(f),a("<h2></h2>").html(d.name+" "+d.version).appendTo(f),a.webos.label(d.description).appendTo(f),a.webos.label("D&eacute;velopp&eacute; par "+d.author).addClass("detail").appendTo(f),"undefined"!=typeof d.website&&a("<a></a>",{href:d.website}).html("Site Web de "+d.name).appendTo(f);var g=a.webos.buttonContainer().appendTo(f);return a.webos.button("Fermer").click(function(){e.window("close")}).appendTo(g),e},a.webos.window.dialog=function(b){var c=a.webos.window(a.extend({resizable:!1},b));return c.window("dialog",!0),c},a.webos.window.confirm=function(b){var c={title:"Confirmation",label:"&Ecirc;tes-vous s&ucirc;r de vouloir effectuer cette action ?",details:"",cancel:function(){},confirm:function(){},cancelLabel:"Annuler",confirmLabel:"Valider"},d=a.extend(c,b),e=a.webos.window.dialog({title:d.title,icon:"actions/help",parentWindow:d.parentWindow,resizable:!1,hideable:!1,width:450}),f=a.w.entryContainer().appendTo(e.window("content"));a.w.icon("actions/help").css("float","left").appendTo(f),a("<strong></strong>").html(d.label).appendTo(f),d.details&&a.w.label(d.details).appendTo(f);var g=a.w.buttonContainer().css("clear","both").appendTo(f);return a.w.button(d.cancelLabel).click(function(){e.window("close"),d.cancel()}).appendTo(g),a.w.button(d.confirmLabel,!0).appendTo(g),f.submit(function(){e.window("close"),d.confirm()}),e},a.webos.window.messageDialog=function(b){b||(b={});var c={type:"information",title:"Message",label:"",details:"",closeLabel:"Fermer"};switch(b.type){case"information":c.title="Information";break;case"error":c.title="Erreur",c.label="Une erreur est survenue.";break;case"warning":c.title="Attention"}var d=a.extend(c,b),e=new W.Icon("status/info");switch(d.type){case"information":e="status/info";break;case"error":e="status/error";break;case"warning":e="status/warning"}var f=a.webos.window.dialog({title:d.title,icon:e,parentWindow:d.parentWindow,resizable:!1,hideable:!1,width:450}),g=f.window("content");a.w.icon(e).css("float","left").appendTo(g),a("<strong></strong>").html(d.label).appendTo(g),d.details&&a.w.label(d.details).appendTo(g);var h=a.w.buttonContainer().css("clear","both").appendTo(g);return a.w.button(d.closeLabel).click(function(){f.window("close")}).appendTo(h),f},a.webos.window.zIndexRange=[1005,5e3],a.webos.window.currentZIndex=a.webos.window.zIndexRange[0],a.webos.window.requestZIndex=function(){var b=a.webos.window.currentZIndex+1;if(b>a.webos.window.zIndexRange[1]){var c=b-a.webos.window.zIndexRange[0];a.webos.window.getWindows().each(function(){var b=parseInt(a(this).css("z-index"));b>a.webos.window.zIndexRange[0]&&a(this).css("z-index",b-c)}),b-=c}return a.webos.window.currentZIndex=b,b},a.webos.window.hideAll=function(){var b=a(a.w.window.workspace?a.w.window.workspace.getCurrent().getWindows():a.webos.window.getWindows());b.each(function(){a(this).window("hide")})},a.webos.window.showAll=function(){var b=a(a.w.window.workspace?a.w.window.workspace.getCurrent().getWindows():a.webos.window.getWindows());b.each(function(){a(this).window("show")})},a.webos.window.hideOrShowAll=function(){var b=a(a.w.window.workspace?a.w.window.workspace.getCurrent().getWindows():a.webos.window.getWindows());b.each(function(){a(this).window("hideOrShow")})},a.webos.window.getActive=function(){var b=a(a.w.window.workspace?a.w.window.workspace.getCurrent().getWindows():a.webos.window.getWindows());if(b.length>0){var c=a(),d=a.webos.window.zIndexRange[0];return b.each(function(){var b=parseInt(a(this).css("z-index"));a(this).window("is","hidden")||(0==c.length||b>d)&&(c=a(this),d=b)}),c}return a()},a.webos.window.allToBackground=function(){var b=a(a.w.window.workspace?a.w.window.workspace.getCurrent().getWindows():a.webos.window.getWindows());b.each(function(){a(this).window("toBackground")})},a.webos.window.allToBackGroundExcluding=function(b){var c=a(a.w.window.workspace?a.w.window.workspace.getCurrent().getWindows():a.webos.window.getWindows());c.each(function(){a(this).window("id")!=a(b).window("id")&&a(this).window("toBackground")})},a.webos.window.getWindows=function(){return a("#desktop").children(".webos-window").not(".closing")},a.webos.window.getWindowById=function(b){var c=a.webos.window.getWindows(),d=a();return c.each(function(){return a(this).window("option","id")==b?(d=a(this),!1):void 0}),d},a.webos.window._getHidePos=function(){return{top:0,left:0}},a.webos.window.getHidePos=function(b){var c=a.webos.window._getHidePos(b);return{top:c&&c.top>0?c.top:0,left:c&&c.left>0?c.left:0}},a.webos.window.setHidePosFn=function(b){a.webos.window._getHidePos=b};var b=function(){a.webos.window.getWindows().each(function(){a(this).window("is","maximized")&&a(this).window("remaximize",!1)})},c=window.setTimeout(function(){},0);a(window).on("resize",function(){window.clearTimeout(c),c=window.setTimeout(function(){b()},500)}),a.webos.widget("windowHeader","container",{_name:"windowheader"}),a.webos.widget("menuWindowHeader","menu",{_name:"menuwindowheader"}),a.webos.menuWindowHeader=function(b){return a("<ul></ul>").html(b||"").menuWindowHeader()},a.webos.widget("menuWindowHeaderItem","container",{_name:"menuwindowheaderitem",options:{label:""},_create:function(){this._super("_create");var b=this;this.options._components.label=a("<a></a>",{href:"#"}).html(this.options.label).appendTo(this.element),this.options._content=a("<ul></ul>").appendTo(this.element),this.element.bind("click mouseenter",function(c){var d=b.element,e=b.content();if(!d.is("hover")&&("mouseenter"!=c.type||0!=d.parents("ul.webos-menuwindowheader li").length)){if(e.children().length>0)e.show();else if("click"==c.type)return d.removeClass("hover"),void d.parents("ul.webos-menuwindowheader li ul li").hide();d.addClass("hover");var f=function(b){a(b.target).parents().filter(d).length>0&&a(b.target).parents().filter("ul.webos-menuwindowheader li").first().children("ul").children().length>0||(e.hide(),d.removeClass("hover"),a(this).unbind("click",f))};a(document).click(f),c.preventDefault()}}).bind("mouseleave",function(){var a=b.element,c=b.content();0!=a.parents("ul.webos-menuwindowheader li").length&&(a.removeClass("hover"),c.hide())})},_update:function(a,b){switch(a){case"label":this.options._components.label.html(b)}}}),a.webos.menuWindowHeaderItem=function(b){return a("<li></li>").menuItem({label:b})},a.webos.widget("toolbarWindowHeader","windowHeader",{_name:"toolbarwindowheader"}),a.webos.toolbarWindowHeader=function(){return a("<ul></ul>").toolbarWindowHeader()},a.webos.widget("toolbarWindowHeaderItem","container",{_name:"toolbarwindowheaderitem",options:{active:!1},_create:function(){this._super("_create"),"undefined"!=typeof this.options.label&&""!=this.options.label&&this._setLabel(this.options.label),"undefined"!=typeof this.options.icon&&this._setIcon(this.options.icon),this.active(this.options.active)},_setIcon:function(b){if(/^(https?)?\:\/\//.test(b))var c={realpath:function(){return b}};else var c=W.Icon.toIcon(b);"undefined"==typeof this.options._components.icon&&(this.options._components.icon=a("<img />",{alt:""}).prependTo(this.element)),this.options._components.icon.attr("src",c.realpath(22))},_setLabel:function(b){"undefined"==typeof this.options._components.label&&(this.options._components.label=a("<span></span>").appendTo(this.element)),this.options._components.label.html(b)},active:function(a){return"undefined"==typeof a?this.options.active:(this.options.active=a?!0:!1,void(this.options.active?this.element.addClass("active"):this.element.removeClass("active")))},_update:function(a,b){switch(a){case"icon":this._setIcon(b);break;case"label":this._setLabel(b);break;case"active":this.active(b)}}}),a.webos.toolbarWindowHeaderItem=function(b,c){return a("<li></li>").toolbarWindowHeaderItem({label:b,icon:c})},a.webos.widget("windowHeaderSearch","searchEntry",{}),a.webos.windowHeaderSearch=function(){return a("<li></li>").windowHeaderSearch()},a.webos.widget("buttonWindowHeader","windowHeader",{_name:"buttonwindowheader"}),a.webos.buttonWindowHeader=function(){return a("<ul></ul>").buttonWindowHeader()},a.webos.widget("buttonWindowHeaderItem","container",{_name:"buttonwindowheaderitem",_create:function(){this._super("_create"),"undefined"==typeof this.options.icon&&(this.options.icon=""),this.options._components.separator=a("<div></div>").addClass("buttonwindowheaderseparator").appendTo(this.element),this.options._components.icon=a("<img />",{alt:""}).attr("src",this.options.icon).appendTo(this.element),this.element.append("<br />"),this.options._content=a("<span></span>").html(this.options.label).appendTo(this.element);var b=this;this.element.click(function(){b.select()})},icon:function(){return this.options._components.icon},select:function(){this.element.is(".active")||(this.element.parent("ul").children("li.active").removeClass("active").trigger("unselect"),this.element.addClass("active").trigger("update").trigger("select"),this._trigger("select"))}}),a.webos.buttonWindowHeaderItem=function(b,c){return a("<li></li>").buttonWindowHeaderItem({label:b,icon:c})},a.webos.widget("windowHeaderItem","container",{_name:"windowheaderitem"}),a.webos.windowHeaderItem=function(){for(var b=[],c=0;c<arguments.length;c++)b.push(arguments[c]);return a("<li></li>").windowHeaderItem().html(b)}}(jQuery),$.w.window.workspace=function(){Webos.Observable.call(this),this._id=$.w.window.workspace.list.push(this)-1;var a=this._id,b=this;this.switchTo=function(a){var b=this.windows();if(this.id()==a){var c=function(a){a.show()};this._button.addClass("selected","normal")}else{var c=function(a){a.window("toBackground").hide()};this._button.removeClass("selected","normal")}for(var d=0;d<b.length;d++)c(b[d])},this.remove=function(){for(var a=this.windows(),b=0;b<a.length;b++)a[b].window("close");this._button.remove()},this.id=function(){return this._id},this.getId=function(){return this.id()},this.windows=function(){var a=[],b=this._id;return $.webos.window.getWindows().each(function(){$(this).window("workspace").id()==b&&a.push($(this))}),a},this.getWindows=function(){return this.windows()},this._button=$("<span></span>",{"class":"workspace-button",title:"Espace de travail "+(a+1)}).click(function(){$.w.window.workspace.switchTo(b.getId())}).appendTo($.w.window.workspace.switcher),$.w.window.workspace.getCurrent()||$.w.window.workspace.switchTo(this.id())},Webos.inherit($.w.window.workspace,Webos.Observable),Webos.Observable.build($.w.window.workspace),$.w.window.workspace.switcher=$("<div></div>"),$.w.window.workspace.list=[],$.w.window.workspace.current=void 0,$.w.window.workspace.get=function(a){for(var b=0;b<$.w.window.workspace.list.length;b++)if($.w.window.workspace.list[b].id()===a)return $.w.window.workspace.list[b]},$.w.window.workspace.getList=function(){return $.w.window.workspace.list},$.w.window.workspace.getCurrent=function(){return $.w.window.workspace.get($.w.window.workspace.current)},$.w.window.workspace.switchTo=function(a){if($.w.window.workspace.current!==a){var b=$.w.window.workspace.get(a);if("undefined"!=typeof b){var c=$.w.window.workspace.current;"undefined"!=typeof $.w.window.workspace.current&&$.w.window.workspace.getCurrent().switchTo(a),b.switchTo(a),$.w.window.workspace.current=a,$.w.window.workspace.notify("switch",{old:c,current:a})}}},$.w.window.workspace.remove=function(a){if($.w.window.workspace.current!==a){var b=$.w.window.workspace.get(a);if(b){b.remove();for(var c=[],d=$.w.window.workspace.getList(),e=0;e<d.length;e++)d[e].id()!=a&&c.push(d[e]);$.w.window.workspace.list=c,$.w.window.workspace.notify("remove",{removed:a})}}},function(){if(Webos.Compiz||(Webos.Compiz={}),!Webos.Compiz.Reviver){var a={};a.revive=function(b){b=Webos.Callback.toCallback(b),Webos.User.get([function(c){if(c){var d=!1;a.loadConfig([function(a){d=1==a.get("saveSessionOnExit")},b.error]),Webos.File.get("~/.cache/compiz/saved-session.json").readAsText([function(c){var e=JSON.parse(c);if($.webos.window.main.windowsDisplay(e.windowsDisplay),e.openedWindows)if(d)for(var f=0;f<e.openedWindows.length;f++)W.Cmd.execute(e.openedWindows[f].cmd);else a.save([function(){b.success()},b.error]);b.success()},b.error])}else b.error()},b.error])},a.loadConfig=function(a){a=Webos.Callback.toCallback(a),Webos.ConfigFile.loadUserConfig("~/.config/exiting.xml",null,[function(b){1==b.get("saveSessionOnExit")?($(window).bind("beforeunload.reviver.compiz.webos",function(){Webos.Compiz.Reviver.saveSync([function(){},function(){}])}),a.success(b)):$(window).unbind("beforeunload.reviver.compiz.webos")},a.error])},a._getSessionData=function(){var a=$.webos.window.main.list(),b=[];return a.each(function(){var a=$(this);if(a.length&&$.webos.widget.is(a,"window")&&a.window("is","opened")&&"number"==typeof a.window("pid")){var c=Webos.Process.get(a.window("pid"));Webos.isInstanceOf(c,Webos.Cmd)&&b.push({cmd:c.cmdText})}}),{windowsDisplay:$.webos.window.main.windowsDisplay(),openedWindows:b}},a.save=function(b){b=Webos.Callback.toCallback(b);var c=a._getSessionData();Webos.User.get([function(a){a?Webos.File.get("~/.cache/compiz/saved-session.json").writeAsText(JSON.stringify(c),[function(){b.success()},b.error]):b.error()},b.error])},a.saveSync=function(b){b=Webos.Callback.toCallback(b);var c=a._getSessionData();Webos.User.get([function(a){if(a){var d=Webos.File.get("~/.cache/compiz/saved-session.json")._writeAsText(JSON.stringify(c));d._options.async=!1,d.load([function(){b.success()},b.error])}else b.error()},b.error])},Webos.Compiz.Reviver=a}}(),$.webos.widget("contextMenu","container",{options:{target:void 0,disabled:!1},_name:"contextmenu",_create:function(){this._super("_create"),"undefined"!=typeof this.options.target&&this._setTarget(this.options.target)},_setTarget:function(a){var b=this;this.element.hide(),a.bind("contextmenu",function(c){if(b.options.disabled)return!1;var d=function(){b.element.fadeOut("fast",function(){$(this).detach()})},e=!1;if($("ul.webos-contextmenu").each(function(){if($(this).is(":visible")){var b=$(this).contextMenu("option","target");a.is(b)?$(this).hide():a.find(b).length>0?e=!0:$(this).hide()}}),e)return!1;var f=c.pageY,g=c.pageX;b.element.appendTo(W.UserInterface.Booter.current().element()).show();var h=f+b.element.height(),i=g+b.element.width();h>$(document).height()&&(f-=b.element.height()),i>$(document).width()&&(g-=b.element.width()),$(document).unbind("click",d),b.element.hide().css({top:f,left:g}).fadeIn("fast"),b.element.find("a").hover(function(){b.element.find("li.hover").removeClass("hover"),$(this).parent().addClass("hover")},function(){b.element.find("li.hover").removeClass("hover")});var j=function(a){d(),a.preventDefault()};b.element.find("a").unbind("click",j),b.element.find("li:not(.disabled) a").click(j),setTimeout(function(){$(document).one("click",d)},0),b._trigger("open")}),this.element.each(function(){$(this).css({"-moz-user-select":"none","-webkit-user-select":"none","-ms-user-select":"none","-o-user-select":"none","user-select":"none"})}),a.add("ul.webos-contextmenu").bind("contextmenu",function(a){a.preventDefault()}),this.options.target=a},destroy:function(){"undefined"!=typeof this.options.target&&this.options.target.unbind("contextmenu")}}),$.webos.contextMenu=function(a){return $("<ul></ul>").contextMenu({target:a})},$.webos.contextMenuItem=function(a,b){return $("<li></li>").menuItem({label:a,separator:b})},function(a){function b(a){return"object"==typeof a?a:{top:a,left:a}}var c=a.scrollTo=function(b,c,d){a(window).scrollTo(b,c,d)};c.defaults={axis:"xy",duration:parseFloat(a.fn.jquery)>=1.3?0:1},c.window=function(){return a(window).scrollable()},a.fn.scrollable=function(){return this.map(function(){var b=this,c=!b.nodeName||-1!=a.inArray(b.nodeName.toLowerCase(),["iframe","#document","html","body"]);if(!c)return b;var d=(b.contentWindow||b).document||b.ownerDocument||b;return a.browser.safari||"BackCompat"==d.compatMode?d.body:d.documentElement})},a.fn.scrollTo=function(d,e,f){return"object"==typeof e&&(f=e,e=0),"function"==typeof f&&(f={onAfter:f}),"max"==d&&(d=9e9),f=a.extend({},c.defaults,f),e=e||f.speed||f.duration,f.queue=f.queue&&f.axis.length>1,f.queue&&(e/=2),f.offset=b(f.offset),f.over=b(f.over),this.scrollable().each(function(){function c(a){j.animate(l,e,f.easing,a&&function(){a.call(this,d,f)})}function g(a){var b="scroll"+a;if(!m)return i[b];var c="client"+a,d=i.ownerDocument.documentElement,e=i.ownerDocument.body;return Math.max(d[b],e[b])-Math.min(d[c],e[c])}var h,i=this,j=a(i),k=d,l={},m=j.is("html,body");switch(typeof k){case"number":case"string":if(/^([+-]=)?\d+(\.\d+)?(px)?$/.test(k)){k=b(k);break}k=a(k,this);case"object":(k.is||k.style)&&(h=(k=a(k)).offset())}a.each(f.axis.split(""),function(a,b){var d="x"==b?"Left":"Top",e=d.toLowerCase(),n="scroll"+d,o=i[n],p="x"==b?"Width":"Height";h?(l[n]=h[e]+(m?0:o-j.offset()[e]),f.margin&&(l[n]-=parseInt(k.css("margin"+d))||0,l[n]-=parseInt(k.css("border"+d+"Width"))||0),l[n]+=f.offset[e]||0,f.over[e]&&(l[n]+=k[p.toLowerCase()]()*f.over[e])):l[n]=k[e],/^\d+$/.test(l[n])&&(l[n]=l[n]<=0?0:Math.min(l[n],g(p))),!a&&f.queue&&(o!=l[n]&&c(f.onAfterFirst),delete l[n])}),c(f.onAfter)}).end()}}(jQuery);var $rootEl=Webos.UserInterface.Booter.current().element();$rootEl.on("click","ul.menu > li",function(a){var b=$(this);b.addClass("hover");var c=function(){var a=b.children("ul").first();a.length>0&&($.fx.off?a.hide():a.animate({top:"+=20",opacity:0},"fast",function(){$(this).hide()})),b.removeClass("hover"),$menuParents=b.parents("ul.menu li"),$menuParents.removeClass("hover"),$menuParents.filter("ul.menu li ul li").hide()},d=function(a){var e=$(a.target).parents().filter(b);if(e.length>0){a.preventDefault();var f=$(a.target).is("li")?$(a.target):$(a.target).parents("li").first();if(f.children("ul").length>0&&""!=f.children("ul").html())return void f.children("ul").first().show()}c(),$(this).unbind("click",d)};if($(document).click(d),b.children("ul").length>0&&b.children("ul").children().length>0){var e=b.children("ul").first();if(e.is(":hidden")){var f=b.parent().offset(),g={top:f.top+b.outerHeight()+18,left:0};e.css(g).show();var h=e.offset(),i=h.left+(e.outerWidth()+e.outerWidth(!0))/2;i>$(document).width()&&(g.left=g.left-(i-$(document).width()),e.css("left",g.left)),$.fx.off?e.css("opacity",1):e.css({top:g.top-20,opacity:0}).animate({top:"+=20",opacity:1},"fast")}}else $(this).removeClass("hover");a.preventDefault()}),$rootEl.on("mouseenter","ul.menu > li li",function(){$(this).addClass("hover"),$(this).children("ul").length>0&&$(this).children("ul").first().show()}).on("mouseleave","ul.menu > li li",function(){$(this).removeClass("hover"),$(this).children("ul").length>0&&$(this).children("ul").first().hide()}),window.SNotification=function(a){return $.webos.notification(a)},SNotification.element=$("<div></div>",{"class":"notifications-area"}).css("display","none").appendTo(W.UserInterface.Booter.current().element()),SNotification.container=$("<div></div>",{"class":"notification-container"}).appendTo(SNotification.element),SNotification.indicators=$("<ul></ul>").appendTo(SNotification.element),SNotification.showContainer=function(){SNotification.showedStack++,SNotification.isContainerVisible()||(SNotification.showed=!0,SNotification.element.stop().fadeIn("fast"))},SNotification.autoShowContainer=function(){SNotification.isContainerVisible()||(SNotification.showed=!0,SNotification.element.stop().fadeIn("fast"))},SNotification.hideContainer=function(){SNotification.showedStack=SNotification.showedStack>0?SNotification.showedStack-1:0,SNotification.showedStack>0||!SNotification.isContainerVisible()||(SNotification.showed=!1,SNotification.element.stop().fadeOut("fast"))},SNotification.autoHideContainer=function(){SNotification.showedStack>0||!SNotification.isContainerVisible()||(SNotification.showed=!1,SNotification.element.stop().fadeOut("fast"))},SNotification.isContainerVisible=function(){return SNotification.element.is(":visible")},SNotification.showedStack=0,$(window).mousemove(function(a){a.pageX<=$(document).width()-3||a.pageY<=$(document).height()-3||SNotification.isContainerVisible()||SNotification.showed||SNotification.autoShowContainer()}),SNotification.element.mouseleave(function(){if(SNotification.showed){var a=setTimeout(function(){SNotification.autoHideContainer()},700);SNotification.element.one("mouseenter",function(){clearTimeout(a)})}}),$.webos.widget("notification","container",{options:{title:"Message",message:"",shortMessage:"",icon:"/usr/share/images/gnome/light.png",life:7,widgets:[]},_name:"notification",_create:function(){this._super("_create");var a=this;if(this.options._components.header=$("<div></div>",{"class":"header"}).appendTo(this.element),$("<img />",{src:W.Icon.toIcon(this.options.icon).realpath(24),alt:"","class":"icon"}).appendTo(this.options._components.header),$("<strong></strong>").html(this.options.title+" : ").appendTo(this.options._components.header),this.options._components.details=$("<span></span>",{"class":"details"}).appendTo(this.options._components.header),this.options._components.content=$("<div></div>",{"class":"content"}).hide().appendTo(this.element),this.options._components.message=$("<div></div>",{"class":"message"}).appendTo(this.options._components.content),this.option("shortMessage",this.options.shortMessage),this.option("message",this.options.message),this.options.widgets.length>0)for(var b=$(),c=0;c<this.options.widgets.length;c++)$.webos.widget.is(this.options.widgets[c],"button")?(0==b.length&&(b=$.w.buttonContainer().appendTo(this.options._components.content)),this.options.widgets[c].appendTo(b)):this.options.widgets[c].appendTo(this.options._components.content);var d=!1;if(this.element.hover(function(){clearTimeout(a.options._timer),a.options._components.details.stop().fadeOut("fast"),a.options._components.content.stop().slideDown("fast")},function(){d||(a.options._components.details.stop().fadeIn("fast"),a.options._components.content.stop().slideUp("fast"),a._startTimer())}).focusin(function(){a.options._components.details.stop().fadeOut("fast"),a.options._components.content.stop().slideDown("fast"),d=!0}).focusout(function(){a.options._components.details.stop().fadeIn("fast"),a.options._components.content.stop().slideUp("fast"),d=!1}).click(function(b){$(b.target).is("input")||a.dismiss()}),SNotification.container.children().length>0){var e=function(b){b?0==SNotification.container.children().not(b.target).length&&(SNotification.container.unbind("notificationdismiss",e),a._show()):SNotification.container.bind("notificationdismiss",e)};e()}else a._show()},_update:function(a,b){switch(a){case"message":this.options._components.message.html(b),this.options.shortMessage||this.options._components.details.html(b);break;case"shortMessage":this.options._components.details.html(b)}},_show:function(){SNotification.showContainer(),this.element.appendTo(SNotification.container);var a=this.element.outerHeight();this.element.css("top",a).animate({top:"-="+a},"fast"),this._startTimer()},_startTimer:function(){var a=this;this.options._timer=setTimeout(function(){a.dismiss()},1e3*this.options.life)},dismiss:function(){var a=this;this.element.animate({top:"+="+this.element.outerHeight()},"fast",function(){a._trigger("dismiss"),a.element.remove(),SNotification.hideContainer()})}}),$.webos.notification=function(a){return $("<div></div>").notification(a)},$.webos.widget("appIndicator","container",{_name:"app-indicator",options:{title:"Application",icon:void 0},_create:function(){this._super("_create");var a=this.options._components.indicator=$("<div></div>",{"class":"indicator"}).appendTo(this.element);this.options._components.icon=$("<img />",{"class":"icon"}).appendTo(a),this.options._components.title=$("<span></span>",{"class":"title"}).appendTo(a),this.options._content=$("<ul></ul>").appendTo(this.element);var b=this;a.css("width","22px").mouseenter(function(){if(!a.is(".expanded")){SNotification.indicators.children("li").children(".indicator.expanded").removeClass("expanded").stop().animate({width:"22px"},"fast"),a.addClass("expanded").css("width","auto");var b=a.width();a.css("width","22px").stop().animate({width:b},"fast")}}).click(function(){var a=b.options._content;if(b.element.children("ul").children().length>0){var c=function(){$.fx.off?a.hide():a.animate({bottom:"+=20",opacity:0},"fast",function(){$(this).hide()}),b.element.removeClass("active"),SNotification.hideContainer()};if(b.element.toggleClass("active"),b.element.is(".active")){var d=b.element.offset(),e={bottom:d.top-$(document).height()+b.element.outerHeight()+23,left:d.left};a.css(e).show();var f=a.offset(),g=f.left+(a.outerWidth()+a.outerWidth(!0))/2;g>$(document).width()&&(e.left=e.left-(g-$(document).width()),a.css("left",e.left)),$.fx.off?a.css("opacity",1):a.css({top:e.top+20,opacity:0}).animate({bottom:"+=20",opacity:1},"fast"),$(document).one("click",function(){$(document).one("click",function(){c()})}),SNotification.showContainer()}else c()}}),this.option("title",this.options.title),this.option("icon",this.options.icon)},_update:function(a,b){switch(a){case"title":this.options._components.title.html(b);break;case"icon":this.options._components.icon.attr("src",W.Icon.toIcon(b).realpath(22))}},show:function(){this.element.appendTo(SNotification.indicators),SNotification.isContainerVisible()||SNotification.autoShowContainer()},hide:function(){this.element.detach()}}),$.webos.appIndicator=function(a){return $("<li></li>").appIndicator(a)},Webos.AppIndicator=function(a){this.options=a;var b=this;this.element=$("<li></li>").appendTo(SNotification.indicators);var c=$("<div></div>",{"class":"indicator"}).appendTo(this.element);$("<img />",{src:W.Icon.toIcon(a.icon).realpath(22),"class":"icon"}).appendTo(c),$("<span></span>",{"class":"title"}).html(a.title).appendTo(c);var d;d="undefined"!=typeof a.menu?$(a.menu).appendTo(this.element):$("<ul></ul>").appendTo(this.element),this.remove=function(){this.element.remove()},"undefined"!=typeof a.click&&c.click(a.click),SNotification.isContainerVisible()||SNotification.autoShowContainer(),c.css("width","22px").mouseenter(function(){if(!c.is(".expanded")){SNotification.container.children("li").children(".indicator.expanded").removeClass("expanded").stop().animate({width:"22px"},"fast"),c.addClass("expanded").css("width","auto");var a=c.width();c.css("width","22px").stop().animate({width:a},"fast")}}),c.click(function(){if(b.element.children("ul").children().length>0){var a=function(){$.fx.off?d.hide():d.animate({bottom:"+=20",opacity:0},"fast",function(){$(this).hide()}),b.element.removeClass("active"),SNotification.hideContainer()};if(b.element.toggleClass("active"),b.element.is(".active")){var c=b.element.offset(),e={bottom:c.top-$(document).height()+b.element.outerHeight()+23,left:c.left};d.css(e).show();var f=d.offset(),g=f.left+(d.outerWidth()+d.outerWidth(!0))/2;g>$(document).width()&&(e.left=e.left-(g-$(document).width()),d.css("left",e.left)),$.fx.off?d.css("opacity",1):d.css({top:e.top+20,opacity:0}).animate({bottom:"+=20",opacity:1},"fast"),$(document).one("click",function(){$(document).one("click",function(){a()})}),SNotification.showContainer()}else a()}})},window.SIndicator=function(a){a.appendTo(SIndicator.container),this.remove=function(){a.remove()}},SIndicator.container=$("<ul></ul>",{"class":"menu"}),Webos.Translation.load(function(a){var b=$("<li></li>"),c=$('<a href="#" style="position: relative;"></a>').appendTo(b),d={idle:$("<img />",{"class":"icon",src:new W.Icon("status/network-idle-symbolic",16),title:a.get("No network activity")}).appendTo(c),transmit_receive:$("<img />",{"class":"icon",src:new W.Icon("status/network-transmit-receive-symbolic",16),title:a.get("Loading, please wait...")}).css("position","absolute").hide().appendTo(c)},e={total:W.ServerCall.getNbrPendingCalls(),pending:W.ServerCall.getNbrPendingCalls(),failed:0},f=$("<ul></ul>").appendTo(b),g=$("<li></li>").appendTo(f),h=$("<li></li>").appendTo(f),i=$("<li></li>").appendTo(f);$("<li></li>",{"class":"separator"}).appendTo(f),$("<li>"+a.get("Reset")+"</li>").click(function(){e={total:0,pending:0,failed:0},j()}).appendTo(f),new SIndicator(b);var j=function(){g.html(a.get("Sent queries : ${total}",{total:e.total})),h.html(a.get("Queries being loaded : ${pending}",{pending:e.pending})),i.html(a.get("Failed queries : ${failed}",{failed:e.failed}))},k=function(){d.transmit_receive.stop().fadeIn("fast")};W.ServerCall.bind("start",k),W.ServerCall.getNbrPendingCalls()>0&&k(),W.ServerCall.bind("complete",function(){d.transmit_receive.stop().fadeOut("fast")}),W.ServerCall.bind("callstart",function(){e.total++,e.pending++,j()}),W.ServerCall.bind("callcomplete",function(a){e.pending>0&&e.pending--,"undefined"==typeof a.call.response||a.call.response.isSuccess()||e.failed++,j()}),j()},"gnome"),Webos.Translation.load(function(a){var b=navigator.battery||navigator.mozBattery||navigator.webkitBattery;if(b){var c=$("<li></li>"),d=$('<a href="#"></a>').appendTo(c),e=$("<img />",{"class":"icon"}).appendTo(d);new SIndicator(c);var f={caution_charging:new W.Icon("status/battery-caution-charging-symbolic"),caution:new W.Icon("status/battery-caution-symbolic"),empty_charging:new W.Icon("status/battery-empty-charging-symbolic"),empty:new W.Icon("status/battery-empty-symbolic"),full_charged:new W.Icon("status/battery-full-charged-symbolic"),full_charging:new W.Icon("status/battery-full-charging-symbolic"),full:new W.Icon("status/battery-full-symbolic"),good_charging:new W.Icon("status/battery-good-charging-symbolic"),good:new W.Icon("status/battery-good-symbolic"),low_charging:new W.Icon("status/battery-low-charging-symbolic"),low:new W.Icon("status/battery-low-symbolic")},g=function(){var d="",g="",h=b.level;d+=h>.75?"full":h>.5?"good":h>.25?"low":"caution",b.charging?(d+="_charging",g=a.get("Battery charging, ${chargingMinutes} minutes remaining",{chargingMinutes:Math.round(b.chargingTime/60)}),1==h&&(g=a.get("Battery fully charged"))):1==h?(d+="_charged",g=a.get("Battery fully charged, ${dischargingMinutes} minutes remaining",{chargingMinutes:Math.round(b.dischargingTime/60)})):g=a.get("Battery discharging, ${dischargingMinutes} minutes remaining",{chargingMinutes:Math.round(b.dischargingTime/60)}),b.charging&&1==h?c.hide():c.show(),e.attr("src",f[d]).attr("title",g)};b.addEventListener("chargingchange",g),b.addEventListener("chargingtimechange",g),b.addEventListener("dischargingtimechange",g),b.addEventListener("levelchange",g),g()}},"gnome"),function(){if(navigator.mozApps&&navigator.mozApps.checkInstalled){var a=function(){var a=W.File.get("/usr/share/manifests/webos.webapp");return window.location.origin+"/"+window.location.pathname+"/"+a.get("realpath")},b=function(b){b=Webos.Callback.toCallback(b);var c=navigator.mozApps.install(a());c.onsuccess=function(){var a=this.result;b.success(a)},c.onerror=function(){b.error(Webos.Callback.Result.error("Webapp install failed, error: "+this.error.nam))}},c=function(){if($.webos.appIndicator){var a=$.webos.appIndicator({title:"Install "+Webos.name,icon:new W.Icon("actions/document-save")});$installMenuItem=$.w.menuItem("Install "+Webos.name+" on this device").attr("title","You can install the webos to provide a better integration with your device.").click(function(){b(function(){a.appIndicator("hide")
})}).appendTo(a.appIndicator("content")),a.appIndicator("show")}},d=navigator.mozApps.checkInstalled(a());d.onsuccess=function(){d.result||c()}}}(),Webos.require([{path:"/usr/share/css/nautilus/main.css",styleContainer:Webos.UserInterface.Booter.current().element()},{path:"/usr/share/css/nautilus/window.css",process:!1},"/usr/lib/nautilus/widgets.js","/usr/lib/jquery.filedrop.js","/usr/lib/fileuploader.js","/usr/lib/webos/applications.js"],function(){var a=function(a,b){Webos.Observable.call(this),this._translationsName="nautilus",this.bind("translationsloaded",function(c){var d=c.translations;this._window=$.w.window.dialog({title:"undefined"!=typeof a.title?a.title:d.get("File selection"),width:550,icon:new W.Icon("apps/filemanager"),resizable:!1,hideable:!1,parentWindow:a.parentWindow});var e=this;this._callbackCalled=!1,this._nautilus=$.w.nautilusFileSelector({select:function(a,c){e._callbackCalled=!0,e._window.window("close");var d=c.selection;d||(d=[]),!d instanceof Array&&(d=[d]),b(d)},cancel:function(){e._callbackCalled=!0,e._window.window("close"),b([])},selectDirs:a.selectDirs,selectMultiple:a.selectMultiple,exists:a.exists,extensions:a.extensions,mime_type:a.mime_type});var f=this._nautilus.nautilusFileSelector("nautilus");this._shortcuts=$.webos.nautilusFileSelectorShortcuts({open:function(a){f.nautilus("readDir",a)},select:function(a){e._callbackCalled=!0,e._window.window("close"),b(a)},selectDirs:a.selectDirs,selectMultiple:a.selectMultiple,exists:a.exists,extensions:a.extensions,mime_type:a.mime_type}).appendTo(this._window.window("content")),this._nautilus.appendTo(this._window.window("content")),this._window.on("windowclose",function(){e._callbackCalled||b([])}),this._refreshHeader=function(a){var b=this._window.window("header");"undefined"!=typeof this._toolbar&&this._toolbar.remove(),this._toolbar=$.w.toolbarWindowHeader().appendTo(b);var c=a.split("/"),e=function(a,b){var c=$.w.toolbarWindowHeaderItem(a);return c.click(function(){f.nautilus("readDir",b)}),c};if("/"==a)e("/","/").appendTo(this._toolbar);else for(var g="",h=0;h<c.length;h++){g+=c[h]+"/";var i=c[h];""===i&&(i="/"),"~"==i&&(i=d.get("Private folder"));var j=e(i,g);this._toolbar.append(j)}this._toolbar.find("li").last().addClass("active")},f.on("nautilusreadstart",function(a,b){e._refreshHeader(b.location),e._window.window("loading",!0)}).on("nautilusreadcomplete",function(){e._window.window("loading",!1)}).on("nautilusreaderror",function(a,b){e._refreshHeader(b.location)}),$.webos.widget.is(f,"nautilus")&&this._refreshHeader(f.nautilus("location")),this._window.window("open"),this.trigger("ready")}),Webos.TranslatedLibrary.call(this)};Webos.inherit(a,Webos.Observable),Webos.inherit(a,Webos.TranslatedLibrary),window.NautilusFileSelectorWindow=a;var b=function(a){Webos.Observable.call(this),this._translationsName="nautilus",this.bind("translationsloaded",function(b){var d=b.translations,e=W.Process.current(),f=!0;e&&(f=e.getAuthorizations().can("file.user.write")),this._window=$.w.window.dialog({title:d.get("Volume mounting"),width:400,icon:new W.Icon("devices/harddisk")}),this._drivers={FTPFile:{title:"FTP",icon:"places/folder-remote",lib:"/usr/lib/webos/ftp.js"},DropboxFile:{title:"Dropbox",icon:"applications/dropbox",lib:"/usr/lib/dropbox/webos.js"},GoogleDriveFile:{title:"Google Drive",icon:"applications/google-drive",lib:"/usr/lib/google-api/webos.js"},WebosFile:{title:"Webos",icon:"places/folder-remote"}};for(var g in this._drivers)this._drivers[g]=$.extend({title:"Unknown driver",icon:"places/folder-remote",lib:null},this._drivers[g]);this.showDrivers=function(a){var b=this,e=$.w.entryContainer().submit(function(){b._drivers[h].lib&&(b._window.window("loading",!0,{message:d.get("Loading of ${driver} library in progress...",{driver:b._drivers[h].title})}),W.ScriptFile(b._drivers[h].lib));var a=m.nautilusFileEntry("value"),e=n.textEntry("value"),g=o.switchButton("value"),i=new Webos.File.MountPoint({remote:e,driver:h},a),j=function(){b._window.window("loading",!0,{message:d.get("Mounting of ${driver} volume in progress...",{driver:b._drivers[h].title})});var e=function(){$.w.notification({title:d.get("${driver} has been mounted",{driver:b._drivers[h].title}),message:d.get("${driver} has been mounted on  ${local} .",{driver:b._drivers[h].title,local:a}),icon:b._drivers[h].icon,widgets:[$.w.button(d.get("Unmount")).click(function(){Webos.File.umount(a)}),$.w.button(d.get("Open")).click(function(){new c(a)})]})};Webos.File.mount(i,[function(a){g?(b._window.window("loading",!0,{message:d.get("Adding persistant mounting...")}),Webos.File.fstab.add(a,[function(){b._window.window("close"),e()},function(a){b._window.window("loading",!1),a.triggerError(d.get("Can't perform the persistant mounting"))}])):(b._window.window("close"),e())},function(a){b._window.window("loading",!1),a.triggerError(d.get("Can't mount the volume"))}])};b._window.window("loading",!0,{message:d.get('Checking local folder "${local}"...',{local:a})}),f?W.File.load(a,[function(c){return c.get("is_dir")?Webos.isInstanceOf(c,Webos.WebosFile)?void j():(b._window.window("loading",!1),void Webos.Error.trigger(d.get('Can\'t mount the volume on "${local}" : the specified folder is in a mounted volume',{local:a}))):(b._window.window("loading",!1),void Webos.Error.trigger(d.get('Can\'t mount the volume on "${local}" : the specified file is not a folder',{local:a})))},function(){b._window.window("loading",!0,{message:d.get('Creating the local folder "${local}"...',{local:a})}),W.File.createFolder(a,[function(){j()},function(c){b._window.window("loading",!1),c.triggerError(d.get('Can\'t create the local folder "${local}"',{local:a}))}])}]):j()}).appendTo(this._window.window("content"));e.append($.w.label(d.get("Select the service to use :")));var g=$.w.iconsList(),h=null,i=function(a){b._drivers[a]&&(q.button("option","disabled",!1),k.show(),m.nautilusFileEntry("value","~/"+b._drivers[a].title),h=a)};for(var j in this._drivers)!function(b,c){var d=$.w.iconsListItem(c.icon,c.title).click(function(){i(b)}).appendTo(g);a==b&&d.iconsListItem("active",!0)}(j,this._drivers[j]);g.appendTo(e);var k=$.w.spoiler(d.get("Advanced settings")).hide().appendTo(e),l=k.spoiler("content"),m=$.w.nautilusFileEntry(d.get("Local folder :"),{fileSelector:{selectDirs:!0,exists:!1,title:d.get("Select the local folder"),parentWindow:this._window}}).appendTo(l),n=$.w.textEntry(d.get("Remote folder :"),"/").appendTo(l),o=$.w.switchButton(d.get("Persistant mounting"),f).appendTo(l),p=$.w.buttonContainer().appendTo(e);$.w.button(d.get("Cancel")).click(function(){b._window.window("close")}).appendTo(p);var q=$.w.button(d.get("Confirm"),!0).button("option","disabled",!0).appendTo(p);a&&i(a)},a?this.showDrivers(a):this.showDrivers(),this._window.window("open"),this.notify("ready")}),Webos.TranslatedLibrary.call(this)};Webos.inherit(b,Webos.Observable),Webos.inherit(b,Webos.TranslatedLibrary),window.NautilusDeviceMounterWindow=b;var c=function(a){Webos.Observable.call(this),this.options={location:a},this.on("translationsloaded",function(a){return void this.initialize()}),Webos.TranslatedLibrary.call(this)};c.prototype={_$win:$(),_$nautilus:$(),_$shortcuts:$(),_translationsName:"nautilus",_version:"0.4",initialize:function(){var a=this;W.xtag.loadUI("/usr/share/templates/nautilus/main.html",function(b){a._$win=$(b).filter(":eq(0)");var c=a._$win;c.window("open"),a._initUi()})},_initUi:function(){var a=this,b=this._$win,c=this.translations();b.window("option","title",c.get("File manager")),b.find("[data-l10n-prop]").each(function(){}),b.find("x-menuWindowHeader").find("x-menuItem").each(function(){var a=$(this).attr("label");$(this).attr("label",c.get(a))}),this._$shortcuts=$.webos.nautilusShortcuts(function(b){a._$nautilus.nautilus("readDir",b)}).replaceAll(b.find(".nautilus-shortcuts-ctn")),this._$nautilus=$.w.nautilus({directory:this.options.location,readstart:function(b,d){a._refreshHeader(d.location),a.toggleSearch(!1),a._$win.window("loading",!0,{message:c.get("Opening folder  ${name} ...",{name:d.location.replace(/\/$/,"").split("/").pop()})})},readcomplete:function(b,c){a._refreshHeader(c.location),a._$win.window("loading",!1)},readerror:function(b,c){a._refreshHeader(c.location)}}).replaceAll(b.find(".nautilus-ctn"));var d={"btn-file-new-window":function(){W.Cmd.execute('nautilus "'+a._$nautilus.nautilus("location")+'"')},"btn-file-upload":function(){a._$nautilus.nautilus("openUploadWindow")},"btn-file-new-folder":function(){a._$nautilus.nautilus("createFile",c.get("New folder"),!0)},"btn-file-new-file":function(){a._$nautilus.nautilus("createFile",c.get("New file"))},"btn-file-mount":function(){W.Cmd.execute("nautilus-mounter")},"btn-file-quit":function(){a._$win.window("close")},"btn-edit-select-all":function(){a._$nautilus.nautilus("items").addClass("active")},"btn-edit-select-filter":function(){var b=$.w.window.dialog({parentWindow:a._$win,title:c.get("Select elements corresponding to..."),width:400,resizable:!1,hideable:!1}),d=$.w.entryContainer().appendTo(b.window("content")).submit(function(){var c=e.textEntry("content").val(),d=new RegExp(c);b.window("close"),a._$nautilus.nautilus("items").each(function(){d.test($(this).data("file")().getAttribute("basename"))&&$(this).addClass("active")})}),e=$.w.textEntry(c.get("Pattern (regex) :")).appendTo(d);$.w.label("<strong>"+c.get("Samples")+"</strong> : <em>.png$</em>, <em>fich</em>, <em>^.</em>...").appendTo(d);var f=$.w.buttonContainer().appendTo(d);$.w.button("Valider",!0).appendTo(f),b.window("open"),e.textEntry("content").focus()},"btn-edit-select-invert":function(){a._$nautilus.nautilus("items").toggleClass("active")},"btn-edit-search":function(){a.toggleSearch()},"btn-view-order-name":function(){a._$nautilus.nautilus("option","sort","basename")},"btn-view-order-size":function(){a._$nautilus.nautilus("option","sort","size")},"btn-view-order-type":function(){a._$nautilus.nautilus("option","sort","mime_type")},"btn-view-order-mtime":function(){a._$nautilus.nautilus("option","sort","mtime")},"btn-view-order-atime":function(){a._$nautilus.nautilus("option","sort","atime")},"btn-view-grid":function(){a._$nautilus.nautilus("option","display","icons")},"btn-view-list":function(){a._$nautilus.nautilus("option","display","list")},"btn-view-refresh":function(){a.refresh()},"btn-view-hiddenfiles":function(){var b=!a._$nautilus.nautilus("option","showHiddenFiles");b?$(this).menuItem("option","label",c.get("Don't show hidden files")):$(this).menuItem("option","label",c.get("Show hidden files")),a._$nautilus.nautilus("option","showHiddenFiles",b),a._$nautilus.nautilus("refresh")},"btn-help-about":function(){a.openAboutWindow()},"btn-go-previous":function(){a._$nautilus.nautilus("previous")},"btn-go-next":function(){a._$nautilus.nautilus("next")}};for(var e in d)!function(a){b.find("."+a).click(function(){d[a].call(this)})}(e);var f=function(b){b.trim()&&(a._$win.window("loading",!0,{lock:!1}),a._$nautilus.nautilus("search",b,function(){a._$win.window("loading",!1)}))},g=-1;b.find(".entry-search-query").keydown(function(b){27==b.keyCode&&a.toggleSearch(!1)}).keyup(function(){var a=this;-1!==g&&clearTimeout(g),g=setTimeout(function(){g=-1,f($(a).val())},500)})},refresh:function(){this._$nautilus.nautilus("refresh")},version:function(){return this._version},openAboutWindow:function(){var a=this.translations();$.w.window.about({name:"Nautilus",version:this.version(),description:a.get("${app} allows you to manage your files and folders.",{app:"Nautilus"}),icon:"applications/nautilus",author:"Emersion",parent:this._$win}).window("open")},readDir:function(a,b){var c=this;this._$win.window("loading",!0),this._$nautilus.nautilus("readDir",a,b).on({complete:function(){c._$win.window("loading",!1)}})},toggleSearch:function(a){var b=this._$win.find(".nautilus-header"),c=b.find(".btn-edit-search"),d=b.find(".entry-search-query"),e=b.find(".btn-ctn-location");"undefined"==typeof a&&(a=d.is(":hidden"));var f=d.is(":visible");a&&!f?(c.button("option","activated",!0),d.show().val("").focus(),e.hide()):a?d.focus():!a&&f&&(c.button("option","activated",!1),d.hide(),e.show(),this.refresh())},_refreshHeader:function(a){var b=this.translations(),c=this._$win.find(".nautilus-header"),d=c.find(".btn-ctn-location"),e=String(a).split("/"),f=e[e.length-1];""===f&&(f="/"),this._$win.window("option","title",f+" - "+b.get("File manager"));var g=this,h=function(a,b){var c=$.w.button(a).click(function(){g.readDir(b)}).droppable({drop:function(a,d){if(d.draggable.draggable("option","sourceFile")){var e=d.draggable.draggable("option","sourceFile"),f=Webos.File.get(b);d.draggable.trigger("nautilusdrop",[{source:e,dest:f,droppable:c}])}}});return c};if(d.empty(),"/"==a)h('<x-icon src="devices/drive-harddisk-symbolic" size="16" variant="dark"></x-icon>',"/").appendTo(d);else for(var i="",j=0;j<e.length;j++){i+=e[j]+"/";var k=e[j];""===k&&(k='<x-icon src="devices/drive-harddisk-symbolic" size="16" variant="dark"></x-icon>'),"~"==k&&(k='<x-icon src="places/user-home-symbolic" size="16" variant="dark"></x-icon>');var l=h(k,i);d.append(l)}d.children().last().button("option","activated",!0);var m=this._$nautilus.nautilus("option","display");c.find(".btn-view-grid").button("option","activated","icons"==m),c.find(".btn-view-list").button("option","activated","list"==m)}},Webos.inherit(c,Webos.Observable),Webos.inherit(c,Webos.TranslatedLibrary),window.NautilusWindow=c}),Webos.require("/usr/share/css/gnome-screensaver/main.css",function(){if(!window.GnomeScreenSaver){var a={};a._status=!1,a._locked=!1,a._$screensaver=$(),a._$screenlocker=$(),a._screenlockerClockInterval=null,a.activated=function(){return a._status},a.setStatus=function(b){if(b=b?!0:!1,!Webos.UserInterface.Booter.current())return!1;if(b!=a.activated()){var c=Webos.UserInterface.Booter.current();b?(a._$screensaver=$("<div></div>",{id:"gnome-screensaver"}).hide().one("mousemove",function(){a.deactivate()}).appendTo(c.element()).fadeIn(),a.trigger("activate")):(a._$screensaver.stop().fadeOut("fast",function(){$(this).remove()}),a.trigger("deactivate")),a._status=b}},a.activate=function(){a.setStatus(!0)},a.deactivate=function(){a.setStatus(!1)},a.locked=function(){return a._locked},a.lock=function(){return Webos.UserInterface.Booter.current()?void(a.locked()||(Webos.Translation.load(function(b){a._$screenlocker=$("<div></div>",{id:"gnome-screenlocker"});var c=$("<div></div>",{"class":"screenlocker-prompt"}).hide().appendTo(a._$screenlocker),d=$("<div></div>",{"class":"screenlocker-overlay"}).hide().appendTo(a._$screenlocker),e=$("<div></div>",{"class":"desktop-bar"}).appendTo(a._$screenlocker);Webos.Theme&&Webos.Theme.current()&&Webos.Theme.current().applyBackgroundOn(d);var f=$("<div></div>",{"class":"clock-container"}).appendTo(d),g=$("<div></div>",{"class":"clock"}).appendTo(f),h=$("<div></div>",{"class":"clock-time"}).appendTo(g),i=$("<div></div>",{"class":"clock-date"}).appendTo(g),j=function(){var a=Webos.Locale.current(),b=a.time(new Date),c=a.date(new Date);h.html(b),i.html(c)};setTimeout(function(){a._screenlockerClockInterval=setInterval(function(){j()},6e4),j()},1e3*(60-(new Date).getSeconds())),j(),$("<div></div>",{"class":"arrow-up"}).appendTo(d);var k=$("<span></span>").html("User");if($("<ul></ul>",{"class":"menu"}).append($("<li></li>").append($.webos.image(new Webos.Icon("status/lock-symbolic",16)).addClass("icon"),k)).appendTo(e),a.activated())a._$screenlocker.insertBefore(a._$screensaver);else{var l=Webos.UserInterface.Booter.current();a._$screenlocker.appendTo(l.element())}{var m=a._$screenlocker.height();a._$screenlocker.width()}d.ui_draggable({containment:[0,-m,0,0],axis:"y"}),d.css("top",-m).show().animate({top:0});var n=$("<div></div>",{"class":"form-container"}).appendTo(c),o=$.w.entryContainer().addClass("form").appendTo(n);$.webos.image(new Webos.Icon("stock/person")).addClass("form-avatar").appendTo(o);var p=$("<div></div>",{"class":"form-realname"}).html("User").appendTo(o),q=$.w.passwordEntry(b.get("Password :")).addClass("form-passwordentry").appendTo(o),r=$("<div></div>",{"class":"form-error"}).appendTo(o),s=$.w.buttonContainer().appendTo(o);$.w.button(b.get("Cancel")).click(function(){d.animate({top:0})}).appendTo(s);var t=$.w.button(b.get("Unlock"),!0).addClass("form-submit").appendTo(s);Webos.User.get([function(e){d.bind("dragstop",function(b,c){var f=-c.position.top/m;f>.2?d.animate({top:-m},"normal","linear",function(){e?q.passwordEntry("content").focus():a._unlock()}):d.animate({top:0})}),d.bind("dragstart",function(){e&&c.show()}),o.submit(function(){t.button("option","disabled")||(t.button("option","disabled",!0),Webos.User.login(e.get("username"),q.passwordEntry("value"),[function(){a._unlock()},function(a){var c=a.getErrorsChannel();401==a.getStatusCode()&&(c=b.get("Bad password"),q.passwordEntry("value","")),r.html(c),q.passwordEntry("content").focus(),t.button("option","disabled",!1)}]))}),e?(p.html(e.get("realname")),k.html(e.get("realname")),Webos.User.logout([function(){},function(){}])):c.hide()},function(){}])},"gnome-screensaver"),a._locked=!0,a.trigger("lock"))):!1},a._unlock=function(){a.locked()&&(a._$screenlocker.fadeOut("fast",function(){$(this).remove()}),clearInterval(a._screenlockerClockInterval),a._locked=!1,a.trigger("unlock"))},a.autoActivate=function(b,c,d){if("undefined"!=typeof a.autoActivate._timer&&(clearInterval(a.autoActivate._timer),delete a.autoActivate._timer),b>0){var e=!1;$(document).off("mousemove.gnomescreensaver").on("mousemove.gnomescreensaver",function(){e=!0}),a.autoActivate._timer=setInterval(function(){e?(e=!1,"undefined"!=typeof a.autoActivate._lockTimer&&(clearInterval(a.autoActivate._lockTimer),delete a.autoActivate._lockTimer)):c?d>0?("undefined"==typeof a.autoActivate._lockTimer&&(a.autoActivate._lockTimer=setTimeout(function(){delete a.autoActivate._lockTimer,a.lock()},1e3*d)),a.activate()):(a.lock(),a.activate()):a.activate()},1e3*b)}},a.loadConfig=function(b){b=Webos.Callback.toCallback(b),Webos.ConfigFile.loadUserConfig("~/.config/exiting.xml",null,[function(c){var d=0,e=!1,f=0;c.get("shutdownScreen")>0&&(d=60*parseFloat(c.get("shutdownScreen")),e=1==c.get("lockScreenEnabled"),e&&(f=60*parseFloat(c.get("lockScreenTime")))),a.autoActivate(d,e,f),b.success()},b.error])},Webos.Observable.build(a),window.GnomeScreenSaver=a}}),function(){Webos.xtag||Webos.require("/usr/lib/xtag/core.min.js",function(){var a={};a.register=function(a,b){window.xtag.register("x-"+a,b)},a.registerFromWidget=function(b,c){var d=function(a,b){if("boolean"==typeof c.options[a])b="false"==b||"0"==b?!1:!0;else if("number"==typeof c.options[a]){var d=parseFloat(b);isNaN(d)||(b=d)}return b};a.register(b.replace(".","-"),{lifecycle:{created:function(){for(var a={},c=0;c<this.attributes.length;c++){var e=this.attributes[c],f=e.nodeName,g=e.value;a[f]=d(f,g)}$(this)[b](a)},attributeChanged:function(a,c,e){"id"!=a&&"class"!=a&&$(this)[b]("option",a,d(a,e))}}})},a.importWidgets=function(){var b=$.webos.widget.list();for(var c in b)a.registerFromWidget(c,b[c].prototype)},a.parse=function(a){var b=$("<div></div>").html(a);window.xtag.innerHTML(b[0],a);var c=b.children();return c},a.loadUI=function(b,c){b=W.File.get(b),c=W.Callback.toCallback(c),b.readAsText(function(b){var d=a.parse(b);d.detach(),d.parent().empty().remove(),c.success(d)})},Webos.xtag=a,a.importWidgets()})}(),Webos.require(["/usr/lib/webos/applications.js","/usr/lib/html2canvas/html2canvas.min.js","/usr/lib/html2canvas/jquery.html2canvas.js"],function(){return window.Shell?void($("#shell")!=Shell._$shell&&Shell.reload()):(window.Shell={_initialized:!1,_shown:!1,_$shell:$("#shell"),_$launcher:$("#shell .launcher"),_$workspaces:$("#shell .workspaces"),_backgroundImageData:null,_backgroundImageURL:null,_$searchEntry:$("#shell .content input.search-entry"),_$overlay:$(),_$appsCategories:$("#shell .shortcuts .filters"),_$appsList:$("#shell .shortcuts .list"),_cmds2Windows:{},_translations:null,show:function(a){this._shown=!0,$("#desktop > .webos-nautilus").hide(),this._$shell.show(),$("#shell .content").width(this._$shell.innerWidth()-this._$launcher.outerWidth()-this._$workspaces.outerWidth()),this._renderLauncher(),this._renderWindowsThumbnails(a),SNotification.showContainer(),this._generateWorkspaces();var b=this;$(window).bind("keydown.search.shell.webos",function(a){$(a.target).is("input")||b._$searchEntry.focus()}),this.notify("show")},hide:function(a){this._shown=!1,this._$searchEntry.val(""),this._$shell.hide(),$("#desktop > .webos-nautilus").show(),SNotification.hideContainer(),$(window).unbind("keydown.search.shell.webos"),this._restoreWindows(a),this.notify("hide")},shown:function(){return this._shown},toggle:function(){this.shown()?this.hide():this.show()},_renderWindowsThumbnails:function(a){this._hideShortcuts(),this._showWorkspaces();var b=150,c=100,d=this._$shell.width()-this._$launcher.outerWidth()-this._$workspaces.outerWidth()-b,e=this._$shell.height()-$("#header").outerHeight()-c,f=$.w.window.workspace.getCurrent().getWindows();if(0!=f.length){var g="fast";(a===!1||$.fx.off)&&(g=0);var h=b-5,i=c-5;this._$shellOverlay&&0!=this._$shellOverlay.length?this._$shellOverlay.empty().show():(this._$shellOverlay=$("<div></div>",{id:"gnome-shell-overlay"}).css({position:"absolute",left:h+"px",top:i+"px",width:d+5+"px",height:e+5+"px","z-index":9999}).appendTo(Webos.UserInterface.Booter.current().element()),$.support.transition||this._$shellOverlay.addClass("fallback"));for(var j=1,k=f.length;k>j;)j++,k=Math.ceil(f.length/j);for(var l=10,m=30,n=Math.floor(d/j)-l,o=Math.floor(e/k)-m,p=this,q=0;q<f.length;q++)!function(a,e){var q,r,s={element:e};e.stop().css("display","block"),e.window("is","hidden")?(e.css({top:0,left:0,width:"auto",height:"auto"}),q=e.outerWidth(),r=e.outerHeight(),e.css({width:0,height:0,opacity:0}).animate({opacity:1,width:q,height:r},{duration:g,queue:!1})):(q=e.outerWidth(),r=e.outerHeight());var t=a%j,u=Math.floor(a/j),v=n,w=o;if(u==k-1&&k>1){var x=f.length%j;0==x&&(x=j),v=Math.floor(d/x)-l}var y=1;if(q>v||r>w){var z=v/q,A=w/r;y=Math.min(z,A)}s.width=Math.round(q*y),s.height=Math.round(r*y);var B=e.offset(),C=b+t*(v+l)+((q+v)/2-q),D=c+u*(o+m)+((r+o)/2-r);s.left=Math.round(C+(q-s.width)/2),s.top=Math.round(D+(r-s.height)/2);var E=C-B.left,F=D-B.top,G=s.left-h,H=s.top-i,I=$("<div></div>").css({position:"absolute",left:G+"px",top:H+"px",width:s.width+"px",height:s.height+"px"}).click(function(a){$(a.target).is(".window-close")||(p.hide(),e.window(e.is(".hidden-window")?"show":"toForeground"))}).appendTo(p._$shellOverlay);$("<div></div>",{"class":"window-close"}).click(function(){$(this).remove(),e.window("close")}).appendTo(I);var J=$("<div></div>",{"class":"window-label"}).html("<span>"+e.window("option","title")+"</span>").hide().appendTo(I);if(!$.support.transition){var K=$("<div></div>",{"class":"icon"}).appendTo(I);$("<img />",{src:e.window("option","icon").realpath(92)}).appendTo(K)}$.support.transition?e.addClass("animating").transition({x:E,y:F,scale:y},g,function(){J.fadeIn(g)}):(e.fadeOut(g),J.fadeIn(g))}(q,f[q])}},_restoreWindows:function(a){var b="fast";(a===!1||$.fx.off)&&(b=0);for(var c=$.w.window.workspace.getCurrent().getWindows(),d=0;d<c.length;d++)!function(a){if($.support.transition){var c;c=a.window("is","hidden")?{x:0,y:0,scale:1,opacity:0,width:0,height:0}:{x:0,y:0,scale:1},a.show().stop().transition(c,b,function(){a.removeClass("animating")})}else a.window("is","hidden")||a.fadeIn(b)}(c[d]);"undefined"!=typeof this._$shellOverlay&&(this._$shellOverlay.fadeOut(b,function(){$(this).remove()}),this._$shellOverlay=$())},showWindows:function(){if(this._hideShortcuts(),this._showWorkspaces(),$.support.transition)for(var a=$.w.window.workspace.getCurrent().getWindows(),b=0;b<a.length;b++)a[b].show();"undefined"!=typeof this._$shellOverlay&&this._$shellOverlay.show()},_hideWindows:function(){if($.support.transition)for(var a=$.w.window.workspace.getCurrent().getWindows(),b=0;b<a.length;b++)a[b].hide();"undefined"!=typeof this._$shellOverlay&&this._$shellOverlay.hide()},_showAppsCategories:function(a){var b=this,c=this.translations();this._$appsCategories.empty(),$("<li></li>",{title:c.get("Show all applications"),"class":"active"}).html(c.get("All")).click(function(){$(this).parent().children(".active").removeClass("active"),$(this).addClass("active"),b._$searchEntry.val()?b.showAppsBySearch(b._$searchEntry.val()):b.showAllApps()}).appendTo(this._$appsCategories);var d=[];for(var e in a)!function(a,c){c.get("category")&&-1==jQuery.inArray(c.get("category"),d)&&(Webos.Application.category(c.get("category"),function(a){a&&$("<li></li>",{title:a.description}).html(a.title).click(function(){$(this).parent().children(".active").removeClass("active"),$(this).addClass("active"),b._$searchEntry.val()?Webos.Application.listByCategory(a.name,function(a){Webos.Application.listBySearch(b._$searchEntry.val(),function(a){b._showShortcurts(a)},a)}):b.showAppsByCat(a.name)}).appendTo(b._$appsCategories)}),d.push(c.get("category")))}(e,a[e])},_showShortcurts:function(a){var b=this,c=this.translations();this._hideWindows(),this._hideWorkspaces(),$("#shell .shortcuts").show(),$("#desktop #shell .mode li.windows.active").removeClass("active"),$("#desktop #shell .mode li.applications").addClass("active");var d=this._$appsList;d.unbind("scrollpanescroll.shell.ui.webos"),d.scrollPane({autoReload:!0,forceStyledScrollbars:!0}).scrollPane("content").empty();var e=$("<ul></ul>").appendTo(d.scrollPane("content")),f=$();for(var g in a)!function(a,g){if(!("undefined"!=typeof g.get("hidden")&&1==parseInt(g.get("hidden"))||"undefined"!=typeof g.get("menu")&&"places"==g.get("menu"))){var h=$("<li></li>",{title:g.get("description")}).draggable({data:g,dragImage:$("<img />",{src:new W.Icon(g.get("icon"),48)}).css({height:"48px",width:"48px"})});"undefined"!=typeof b._cmds2Windows[g.get("command")]?h.addClass("active").click(function(){var a=b._cmds2Windows[g.get("command")];a.window("workspace").id()!=$.w.window.workspace.getCurrent().id()&&$.w.window.workspace.switchTo(a.window("workspace").id()),b.hide(),a.window(a.window("is","hidden")?"show":"toForeground")}):h.click(function(){b.hide(),W.Cmd.execute(g.get("command"))});var i=$.w.icon(g.get("icon"),92).appendTo(h);i.icon("option",{loadHidden:!1,animate:!0,parent:d}),$("<br />").appendTo(h),$("<span></span>",{"class":"title"}).html(g.get("title")).appendTo(h),f=f.add(i);var j=$.w.contextMenu(h);$.webos.menuItem(c.get("New window")).click(function(){b.hide(),W.Cmd.execute(g.get("command"))}).appendTo(j),g.get("favorite")!==!1?$.webos.menuItem(c.get("Remove from favorites"),!0).click(function(){b.removeFavorite(g)}).appendTo(j):$.webos.menuItem(c.get("Add to favorites"),!0).click(function(){b.addFavorite(g)}).appendTo(j),h.appendTo(e)}}(g,a[g]);d.scrollPane("reload"),f.icon("load")},_clickOnFirstShortcut:function(){$("#shell .shortcuts .list ul:first li:first").click()},_hideShortcuts:function(){$("#shell .shortcuts").hide(),$("#desktop #shell .mode li.applications.active").removeClass("active"),$("#desktop #shell .mode li.windows").addClass("active")},showAllApps:function(){var a=this;Webos.Application.list(function(b){a._showAppsCategories(b),a._showShortcurts(b)})},showAppsByCat:function(a,b){var c=this;Webos.Application.listByCategory(a,function(a){c._showShortcurts(a)},b)},showAppsBySearch:function(a,b){var c=this;Webos.Application.listBySearch(a,function(a){c._showAppsCategories(a),c._showShortcurts(a)},b)},addFavorite:function(a){var b=this,c=this.translations();Webos.Application.listFavorites(function(d){a.set("favorite",d.length+1),a.sync([function(){b._renderLauncher()},function(b){b.triggerError(c.get('Cannot add "${app}" to favorites',{app:a.get("title")}))}])})},removeFavorite:function(a){var b=this,c=this.translations();a.set("favorite",0),a.sync([function(){b._renderLauncher()},function(b){b.triggerError(c.get('Cannot remove "${app}" from favorites',{app:a.get("title")}))}])},_renderLauncher:function(){var a=this,b=this.translations();Webos.Application.listFavorites(function(c){var d=!1;0==a._$launcher.children().length&&(d=!0),a._$launcher.empty();var e=$.w.window.workspace.getCurrent().getWindows();if(0==c.length&&0==e.length)return void a._$launcher.hide();for(var f=function(a){return $("<li></li>").addClass("icon").draggable({data:a.app?a.app:null,dragImage:$("<img />",{src:a.icon.realpath(48)}).css({height:"48px",width:"48px"})})},g=[],h=0;h<c.length;h++)!function(c,d){var e=f({icon:new W.Icon(d.get("icon"),48),app:d}).appendTo(a._$launcher),h=$();if(a._cmds2Windows[d.get("command")]&&(h=a._cmds2Windows[d.get("command")]),h.length>0){var i=0,j=h.last();h.each(function(){var a=parseInt($(this).css("z-index"));a>=i&&(j=$(this),i=a)}),e.addClass("active").click(function(){j.window("workspace").id()!=$.w.window.workspace.getCurrent().id()&&$.w.window.workspace.switchTo(j.window("workspace").id()),a.hide(),j.window(j.window("is","hidden")?"show":"toForeground")}),h.each(function(){g.push($(this).window("id"))})}else e.click(function(){a.hide(),W.Cmd.execute(d.get("command"))});$("<img />",{src:new W.Icon(d.get("icon"),48),alt:d.get("title"),title:d.get("title")}).appendTo(e);var k=$.w.contextMenu(e);$.webos.menuItem(b.get("New window")).click(function(){a.hide(),W.Cmd.execute(d.get("command"))}).appendTo(k),d.get("favorite")!==!1?$.webos.menuItem(b.get("Remove from favorites"),!0).click(function(){a.removeFavorite(d)}).appendTo(k):$.webos.menuItem(b.get("Add to favorites"),!0).click(function(){a.addFavorite(d)}).appendTo(k)}(h,c[h]);for(var h=0;h<e.length;h++)!function(b,c){if(-1==$.inArray(c.window("id"),g)&&("undefined"==typeof c.window("option","parentWindow")||0==c.window("option","parentWindow").length)){var d=f({icon:c.window("option","icon")}).addClass("active").click(function(){c.window("workspace").id()!=$.w.window.workspace.getCurrent().id()&&$.w.window.workspace.switchTo(c.window("workspace").id()),a.hide(),c.window(c.window("is","hidden")?"show":"toForeground")}).appendTo(a._$launcher);$("<img />",{src:c.window("option","icon").realpath(48),alt:c.window("option","title"),title:c.window("option","title")}).appendTo(d)}}(h,e[h]);a._$launcher.show(),d&&$("#shell .content").width(a._$shell.innerWidth()-a._$launcher.outerWidth()-a._$workspaces.outerWidth())})},_drawWorkspace:function(a,b,c,d){var e=this;a.html("<canvas>"+(d?d.id()+1:"+")+"</canvas>");var f=a.children("canvas")[0],g=b.width,h=b.height,i=c.x,j=c.y;if(f.setAttribute("width",g),f.setAttribute("height",h),f.getContext){var k=f.getContext("2d"),l=function(){if(d){var a=d.windows();if(!a.length)return;for(var b=0;b<a.length;b++)!function(a){if(!a.window("is","hidden")){var b=!1;"none"==a.css("display")&&(b=!0,a.show());var c=a.window("dimentions"),d=a.window("position"),e=d.left/i,f=d.top/j,g=c.width/i,h=c.height/j;if($.fx.off){b&&a.hide(),k.fillStyle="white",k.fillRect(e,f,g,h),k.fillStyle="black",k.strokeRect(e,f,g,h);var l=a.window("option","icon"),m=l.realpath(48),n=new Image;n.src=m;var o,p=5,q=48,r=48,s=g/q,t=h/r;o=t>s?s:t;var u=q*o-p,v=r*o-p;u>q&&(u=q),v>r&&(v=r);var w=e+(g-u)/2,x=f+(h-v)/2;k.drawImage(n,w,x,u,v)}else try{a.html2canvas({proxy:null,onrendered:function(c){b&&a.hide(),k.drawImage(c,e,f,g,h)}})}catch(y){}}}(a[b])}},m=Webos.File.get(Webos.Theme.current().get("background")).get("realpath");if(this._backgroundImageData&&this._backgroundImageURL==m&&this._backgroundImageData.width==g&&this._backgroundImageData.height==h)k.putImageData(this._backgroundImageData,0,0),l();else{k.fillStyle="white",k.fillRect(0,0,g,h);var m=Webos.File.get(Webos.Theme.current().get("background")).get("realpath"),n=new Image;n.onload=function(){var a,b=g/n.width,c=h/n.height;a=b>c?b:c;var d=n.width*a,f=n.height*a,i=(g-d)/2,j=(h-f)/2;k.drawImage(n,i,j,d,f),e._backgroundImageData=k.getImageData(0,0,g,h),e._backgroundImageURL=m,l()},n.src=m}}},_generateWorkspaces:function(){var a=this,b=$.w.window.workspace.getList(),c=!1;b.length&&(c=b[b.length-1].windows().length>0);
var d=$("#desktop").outerWidth(),e=$("#desktop").outerHeight(),f=(a._$workspaces.width(),a._$workspaces.height()),g=$.w.window.workspace.getList().length+(c?1:0),h=Math.round((f-4*g)/g),i=h>110?110:h,j=e/i,k=Math.round(d/j),l=d/k;k>160&&(k=160,l=d/k,i=Math.round(e/l),j=e/i);for(var c=!1,m=!1,n=!1,o=0;o<b.length;o++)!function(d){m=c,c=d.windows().length>0;var e,f=!1;return a._$workspaces.children("li.workspace").each(function(){$(this).data("workspaceId")==d.id()&&(f=!0,e=$(this))}),!c&&!m&&b.length>1&&$.w.window.workspace.getCurrent().id()!=d.id()?(f&&e.remove(),void $.w.window.workspace.remove(d.id())):(n||(n=0==d.windows().length),void(f&&d.id()!=$.w.window.workspace.getCurrent().id()&&(e.removeClass("active"),e.children("canvas").width()==k&&e.children("canvas").height()==i)||(f||(e=$("<li></li>",{"class":"workspace"}),e.appendTo(a._$workspaces),e.data("workspaceId",d.id()),e.click(function(){$.w.window.workspace.switchTo(d.id()),a._$workspaces.children("li.active").removeClass("active"),e.addClass("active")})),d.id()==$.w.window.workspace.getCurrent().id()&&e.addClass("active"),a._drawWorkspace(e,{width:k,height:i},{x:l,y:j},d))))}(b[o]);if(a._$workspaces.children("li.create-workspace").length>0&&a._$workspaces.children("li.create-workspace").remove(),!n){var p=$("<li></li>",{"class":"create-workspace"});p.click(function(){var b=(new $.w.window.workspace).id();$.w.window.workspace.switchTo(b),a._$workspaces.children("li.active").removeClass("active"),a._generateWorkspaces()}),p.appendTo(a._$workspaces),a._drawWorkspace(p,{width:k,height:i},{x:l,y:j})}},_hideWorkspaces:function(){this._$workspaces.hide(),$("#shell .content").width(this._$shell.innerWidth()-this._$launcher.outerWidth())},_showWorkspaces:function(){this._$workspaces.show(),$("#shell .content").width(this._$shell.innerWidth()-this._$launcher.outerWidth()-this._$workspaces.outerWidth())},translations:function(){return this._translations},init:function(){if(!this._initialized){var a=this;$activitiesMenu=$("#shell-activitiesmenu"),$appMenu=$("#shell-appmenu"),this.on("show",function(){$appMenu.hide(),$activitiesMenu.addClass("hover")}),this.on("hide",function(){$appMenu.show(),$activitiesMenu.removeClass("hover")});var b=!1,c=!1;$activitiesMenu.click(function(b){a.toggle(),b.stopPropagation(),b.preventDefault()}).mouseenter(function(a){b=!(0==a.pageX&&0==a.pageY),0!=a.pageY&&(c=!1)}).mousemove(function(d){b&&!c&&d.pageX<10&&d.pageY<10&&($($.webos.window.getActive()).is(".dragging")||(a.toggle(),c=!0))});var d=$("#shell-calendar"),e=d.find("a"),f=function(){var a=Webos.Locale.current(),b=a.dateAbbreviation(new Date)+", "+a.time(new Date);e.html(b)};setTimeout(function(){setInterval(function(){f()},6e4),f()},1e3*(60-(new Date).getSeconds())),Webos.Locale.bind("change",function(){f()}),f();var g=$("#shell-memenu"),h=g.find(".memenu-username");$('<img src="'+new W.Icon("status/avatar-default-symbolic").realpath(16)+'" class="icon" style="margin-right: 3px;"/>').appendTo(h);var i=$("<span></span>").html("User").appendTo(h),j=g.find(".memenu-submenu");$(window).bind("resize",function(b){!$(b.target).is("*")&&a.shown()&&$("#shell .content").width(a._$shell.innerWidth()-a._$launcher.outerWidth()-a._$workspaces.outerWidth())}),$(document).bind("windowopen",function(b,c){var d=Webos.Process.get(c.window.window("pid"));"undefined"!=typeof d&&(a._cmds2Windows[d.cmd]=a._cmds2Windows[d.cmd]?a._cmds2Windows[d.cmd].add(c.window):c.window)}).bind("windowclose",function(b,c){var d=Webos.Process.get(c.window.window("pid"));"undefined"!=typeof d&&a._cmds2Windows[d.cmd]&&(a._cmds2Windows[d.cmd].length>1?a._cmds2Windows[d.cmd]=a._cmds2Windows[d.cmd].not(c.window):delete a._cmds2Windows[d.cmd])}).bind("windowafteropen windowclose",function(){a.shown()&&(a._restoreWindows(!1),a._renderWindowsThumbnails(!1),a._renderLauncher(),a._generateWorkspaces())}),$.w.window.workspace.bind("switch",function(){a.shown()&&(a._restoreWindows(!1),a._renderWindowsThumbnails(!1),a._generateWorkspaces())}),this._$shell.find(".mode li").click(function(){$(this).is(".active")||($(this).is(".windows")&&a.showWindows(),$(this).is(".applications")&&a.showAllApps())});var k=-1;this._$searchEntry.hover(function(){$(this).addClass("active")},function(){$(this).is(":focus")||$(this).removeClass("active")}).focusin(function(){$(this).addClass("active")}).focusout(function(){$(this).is(":hover")||$(this).removeClass("active")}).bind("keydown",function(b){13==b.keyCode&&(a._clickOnFirstShortcut(),b.preventDefault())}).bind("keyup",function(){-1!==k&&clearTimeout(k),k=setTimeout(function(){k=-1,a.showAppsBySearch(a._$searchEntry.val())},500)}),Webos.Translation.load(function(b){a._translations=b,$activitiesMenu.find("a").html(b.get("Activities")),a._$searchEntry.attr("placeholder",b.get("Search...")),a._$shell.find(".mode li.windows").html(b.get("Windows")),a._$shell.find(".mode li.applications").html(b.get("Applications"));var c=$();$(document).bind("windowopen windowtoforeground",function(a,d){var e=$(d.window);if("undefined"!=typeof e.window("option","parentWindow")&&e.window("option","parentWindow").length>0&&(e=e.window("option","parentWindow")),"undefined"==typeof c||e.window("id")!=c.window("id")){$appMenu.empty();var f=$("<a></a>",{href:"#"}).appendTo($appMenu),g=$("<span></span>",{"class":"icon-container"}).appendTo(f);$("<img />",{src:e.window("option","icon").realpath(48),alt:"","class":"icon"}).appendTo(g),$("<span></span>",{"class":"icon-overlay"}).appendTo(g);var h=$("<div></div>",{"class":"loading"}).appendTo(f),i=$("<span></span>",{"class":"title"}).html(e.window("option","title")).appendTo(f);$appMenuContent=$("<ul></ul>").appendTo($appMenu);var j=$("<li>"+b.get("Quit ${app}",{app:e.window("option","title")})+"</li>").click(function(){e.window("close")}).appendTo($appMenuContent);e.window("is","loading")||h.hide();var k=function(){h.show()},l=function(){h.hide()},m=function(){i.html(e.window("option","title")),j.html(b.get("Quit ${app}",{app:e.window("option","title")}))};e.bind("windowloadingstart",k).bind("windowloadingstop",l).bind("windowchangetitle",m).one("windowclose windowtobackground",function(){e.unbind("windowloadingstart",k).unbind("windowloadingstop",l).unbind("windowchangetitle",m)}),c=e}}).bind("windowclose windowtobackground",function(a,b){b.window.is(c)&&($appMenu.empty(),c=void 0)}),i.html(b.get("User"));var d=!0,e=function(a){j.empty();var c=b.get("Guest");if("undefined"!=typeof a)c=a.get("realname"),a.bind("update",function(a){"realname"==a.key&&i.text(a.value)});else{$("<li>"+b.get("Login...")+"</li>").click(function(){W.Cmd.execute("gnome-login")}).appendTo(j);var e=$("<li>"+b.get("Register")+"</li>").click(function(){W.Cmd.execute("gnome-register")}).hide().appendTo(j);$("<li></li>",{"class":"separator"}).appendTo(j),Webos.User.canRegister(function(a){var c=[$.w.button(b.get("Register")).click(function(){W.Cmd.execute("gnome-register")}),$.w.button(b.get("Login...")).click(function(){W.Cmd.execute("gnome-login")})];a.register?e.show():c=[c[1]],$.w.notification({title:b.get("Welcome to ${webos} !",{webos:Webos.name}),message:b.get("To access your documents please login."),icon:"/usr/share/images/distributor/logo-48.png",widgets:c})})}if(Webos.fullscreen.support){var f=$("<li></li>"),g=function(){f.html(Webos.fullscreen.isFullScreen()?b.get("Exit fullscreen mode"):b.get("Enter fullscreen mode"))};f.click(function(){Webos.fullscreen.isFullScreen()?Webos.fullscreen.cancel():$("body").requestFullScreen(),g()}).appendTo(j),$("<li></li>",{"class":"separator"}).appendTo(j),$(document).bind(Webos.fullscreen.eventName,function(){g()}),g()}if("undefined"!=typeof a){var h=$("<li></li>").addClass("rounded-btns").appendTo(j);$("<span></span>").append($.w.icon("actions/preferences-system-symbolic")).addClass("btn").attr("title",b.get("System settings")).click(function(){W.Cmd.execute("gconf")}).appendTo(h),$("<span></span>").append($.w.icon("actions/lock-symbolic")).addClass("btn").attr("title",b.get("Lock")).click(function(){W.Cmd.execute("gnome-screensaver -l")}).appendTo(h),$("<span></span>").append($.w.icon("actions/system-shutdown-symbolic")).addClass("btn").attr("title",b.get("Logout...")).click(function(){W.Cmd.execute("gnome-logout")}).appendTo(h)}else $("<li>"+b.get("Lock")+"</li>").click(function(){W.Cmd.execute("gnome-screensaver -l")}).appendTo(j),$("<li>"+b.get("Restart")+"</li>").click(function(){W.Cmd.execute("gnome-reboot")}).appendTo(j);d?(i.text(c),d=!1):i.animate({opacity:0},"normal",function(){i.text(c),i.animate({opacity:1})})};W.User.get(new W.Callback(function(a){e(a)},function(){})),Webos.User.on("login.launcher.shell.gnome.webos logout.launcher.shell.gnome.webos",function(a){e(a.user)});var f=$("<li></li>",{"class":"insert"}),g=null;a._$launcher.droppable({over:function(b,c){var d=function(b){var d=!1,e=0;a._$launcher.children("li.icon").each(function(){if(!d&&!c.draggable.is(this)){var a=$(this).offset(),h=$(this).outerHeight(!0);b.pageY>a.top-h/2&&b.pageY<a.top+h/2&&(g=e,f.detach().insertBefore(this),d=!0),b.pageY>a.top+h/2&&b.pageY<a.top+1.5*h&&(g=e+1,f.detach().insertAfter(this),d=!0),e++}})};$(document).bind("mousemove.launcher.shell.ui.webos",function(a){d(a)}),d(b),f.show()},out:function(){$(document).unbind("mousemove.launcher.shell.ui.webos"),f.hide(),g=null},drop:function(c,d){$(document).unbind("mousemove.launcher.shell.ui.webos"),f.hide();var e=d.draggable.draggable("option","data");if(d.draggable.parent().is(a._$launcher)){if(null===g)return;var h=!1,i=0;a._$launcher.children("li.icon").each(function(){h||d.draggable.is(this)||(i==g&&(d.draggable.detach().insertBefore(this),h=!0),i++)}),h||d.draggable.detach().appendTo(a._$launcher)}if(e instanceof Webos.Application){var j=e;Webos.Application.listFavorites(function(){j.set("favorite",g+1),j.sync([function(){a._renderLauncher()},function(a){a.triggerError(b.get('Cannot add "${app}" to favorites',{app:j.get("title")}))}])})}}})},"gnome-shell"),this._initialized=!0}},destroy:function(){Webos.User.off("login.launcher.shell.gnome.webos logout.launcher.shell.gnome.webos")},reload:function(){this._$shell=$("#shell"),this._$launcher=$("#shell .launcher"),this._$workspaces=$("#shell .workspaces"),this._$searchEntry=$("#shell .content input.search-entry"),this._$overlay=$(),this._$appsCategories=$("#shell .shortcuts .filters"),this._$appsList=$("#shell .shortcuts .list"),this._initialized=!1,this.init()}},Webos.Observable.build(Shell),void Shell.init())});var booter=W.UserInterface.Booter.current(),done=booter.async();Webos.require({path:"/usr/lib/gnome/ini.js",optionnal:!0});var resizeDesktopFn=function(){$("#desktop").height($(window).height()-$("#header").outerHeight()),$("#desktop .nautilus").height($(window).height()-$("#header").outerHeight()-20)};$(window).resize(resizeDesktopFn),new $.w.window.workspace,Webos.Error.setErrorHandler(function(a){var b,c,d,e=!0;a instanceof Webos.Error?(b=a.html.message,c=a.html.text.replace("<br />"," - "),d=a.toString(),e=0==a.code||5==String(a.code).substr(0,1)):(b=a.message,c=a.name+" : "+a.message,process=a.process?"Process : "+a.process.getPid()+"; command : <em>"+a.process.cmdText+"</em><br />":"",d=a.name+" : "+a.message+"<br />"+process+"Stack trace :<br />"+a.stack);var f=$(),g=function(){Webos.require("/usr/lib/apport/apport.js",function(){Apport.askDescriptionAndReportError(a),f.window("close")})},h=function(){f=$.webos.window({title:"Error",resizable:!1,width:400,icon:"status/error"});var a=$("<img />",{src:new W.Icon("status/error"),alt:"error"}).css("float","left");f.window("content").append(a),f.window("content").append("<strong>An error occured.</strong><br />"+c);var b=$.w.spoiler("Show details").appendTo(f.window("content"));$("<pre></pre>").html(d).css("height","150px").css("overflow","auto").css("background-color","white").css("padding","2px").appendTo(b.spoiler("content"));var h=$.webos.buttonContainer();e&&$.webos.button("Report this bug...").click(function(){g()}).appendTo(h.buttonContainer("content")),$.webos.button("Close").click(function(){f.window("close")}).appendTo(h.buttonContainer("content")),f.window("content").append(h),f.window("open")},i=[$.w.button("Details").click(function(){h()})];e&&i.push($.w.button("Report this bug...").click(function(){g()})),$.w.notification({title:"An error occured",icon:new W.Icon("status/error"),shortMessage:b,message:c,widgets:i})}),Webos.require("/usr/lib/webos/theme.js",function(){Webos.Theme.once("load",function(){resizeDesktopFn(),done()})});